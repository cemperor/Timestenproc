#include <stdio.h>
#include <sqlca.h>
#include "common.h"
#include "dbcmn.h"
#include "data_insert.h" 
#include "struct.h"

unsigned int Insert_num = 0;

struct STR_TRAIN_DATA_EVENT *data_event;

struct STR_TRAIN_DATA_3G 	 *data_3g;

struct STR_TRAIN_DATA_BD 	*data_bd;

struct STR_TRAIN_DATA_FAULT  *data_fault;



/*add by guo 20160902*/

void update_ap_denfender_mgr(struct AP_DEFENDER_MGR ap_denfender_mgr)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

        UPDATE ap_denfender_mgr SET

            serious_no = trim(:ap_denfender_mgr.serious_no),

            software_no = :ap_denfender_mgr.software_no,

            factory_no = trim(:ap_denfender_mgr.factory_no),

            factory_name = trim(:ap_denfender_mgr.factory_name)

            WHERE t_type_id = trim(:ap_denfender_mgr.t_type_id)

            AND loco_no=trim(:ap_denfender_mgr.loco_no)

            and ab = ap_denfender_mgr.ab;



            if (sqlca.sqlcode != 0)

            {

                memset(temp,0,1024);

                sprintf(temp,"ap_denfender_mgr,%s-%s ORACLE返回值：%d\n",ap_denfender_mgr.t_type_id,ap_denfender_mgr.loco_no,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}



/*add by guo 20160817 */

void insert_ITF_TRAIN_BOUNDARY_TRACK(struct ITF_TRAIN_BOUNDARY_TRACK itf_train_boundary_track)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_TRAIN_BOUNDARY_TRACK (

                    idx,

                    t_type_id,

                    loco_no,

                    tmis_no,

                    tmis_trainname,

                    jzsj,

                    jd,

                    wd

                    )

                VALUES(

                    :itf_train_boundary_track.idx,

                    trim(:itf_train_boundary_track.t_type_id),

                    trim(:itf_train_boundary_track.loco_no),

                    :itf_train_boundary_track.tmis_no,

                    :itf_train_boundary_track.tmis_trainname,

                    to_date(:itf_train_boundary_track.jzsj ,'yyyy-mm-dd hh24:mi:ss'),

                    :itf_train_boundary_track.jd,

                    :itf_train_boundary_track.wd

                    );

            if (sqlca.sqlcode != 0)

            {

                //printf("insert ITF_TRAIN_BOUNDARY_TRACK %s-%s,ORACLE：%d\n",itf_train_boundary_track.t_type_id,itf_train_boundary_track.loco_no,sqlca.sqlcode);

                memset(temp,0,1024);

                sprintf(temp,"insert ITF_TRAIN_BOUNDARY_TRACK,%s-%s,ORACLE：%d\n",itf_train_boundary_track.t_type_id,itf_train_boundary_track.loco_no,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}



/*add by guo 20160817 */

void insert_AP_PARSE_ERROR_LOG(struct PARSE_ERROR_LOG pap_parse_error_info)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO AP_PARSE_ERROR_LOG (

                    t_type_id  ,

                    loco_no    ,

                    datatype ,

                    efield     ,

                    ereason   ,

                    btsj ,

                    rksj

                    )

                VALUES(

                    trim(:pap_parse_error_info.t_type_id),

                    trim(:pap_parse_error_info.loco_no),

                    :pap_parse_error_info.datatype,

                    :pap_parse_error_info.efield,

                    trim(:pap_parse_error_info.ereason),

                    trim(:pap_parse_error_info.btsj),

                    to_date(:pap_parse_error_info.rksj ,'yyyy-mm-dd hh24:mi:ss')

                    );

            if (sqlca.sqlcode != 0)

            {

                memset(temp,0,1024);

                sprintf(temp,"insert insert_AP_PARSE_ERROR_LOG,%s-%s,ORACLE返回值：%d\n",pap_parse_error_info.t_type_id,pap_parse_error_info.loco_no,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}



/* add by guo 20160406 ap_train_boundary_history*/

uchar insert_ap_train_boundary_history(pboundary_history pboundaryinfo)

{

    char temp[256] = {0x00};



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ap_train_boundary_history (

                 idx,

                 t_type_id,

                 loco_no,

                 last_cc,

                 next_cc,

                 last_driverno,

                 next_driverno,

                 last_drivername,

                 next_drivername,

                 last_boundary_time,

                 next_boundary_time,

                 last_sjsd,

                 next_sjsd,

                 last_tmis_no,

                 next_tmis_no,

                 last_tmis_name,

                 next_tmis_name,

                 last_bid,

                 duration_bid,

                 next_bid,

                 rksj

                )

            VALUES(

                :pboundaryinfo->idx,

                trim(:pboundaryinfo->t_type_id),

                trim(:pboundaryinfo->loco_no),

                trim(:pboundaryinfo->last_cc),

                trim(:pboundaryinfo->next_cc),

                :pboundaryinfo->last_driverno,

                :pboundaryinfo->next_driverno,

                trim(:pboundaryinfo->last_drivername),

                trim(:pboundaryinfo->next_drivername),

                to_date(:pboundaryinfo->last_boundary_time ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:pboundaryinfo->next_boundary_time ,'yyyy-mm-dd hh24:mi:ss'),

                :pboundaryinfo->last_sjsd,

                :pboundaryinfo->next_sjsd,

                :pboundaryinfo->last_tmis_no,

                :pboundaryinfo->next_tmis_no,

                trim(:pboundaryinfo->last_tmis_name),

                trim(:pboundaryinfo->next_tmis_name),

                trim(:pboundaryinfo->last_bid),

                trim(:pboundaryinfo->duration_bid),

                trim(:pboundaryinfo->next_bid),

                to_date(:pboundaryinfo->rksj ,'yyyy-mm-dd hh24:mi:ss')

                );

    if (sqlca.sqlcode == 0)

    {

        return 0;

    } else

    {

        sprintf(temp,"loco.%s-%s:ap_train_boundary_history,ORACLE返回值：%d\n",pboundaryinfo->t_type_id,pboundaryinfo->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}



void insert_Train_boundary_Status(pboundary_cur pboundaryinfo)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ap_train_cur_boundary (

                    idx        ,

                    t_type_id  ,

                    loco_no    ,

                    cc       ,

                    driverno     ,

                    drivername   ,

                    pass_boundary_time ,

                    update_time      ,

                    last_bid         ,

                    next_bid   ,

                    sjsd ,

                    tmis_station_no,

                    tmis_station_name

                    )

                VALUES(

                    :pboundaryinfo->idx,

                    trim(:pboundaryinfo->t_type_id),

                    trim(:pboundaryinfo->loco_no),

                    trim(:pboundaryinfo->cc),

                    :pboundaryinfo->driverno,

                    trim(:pboundaryinfo->drivername),

                    to_date(:pboundaryinfo->pass_boundary_time ,'yyyy-mm-dd hh24:mi:ss'),

                    to_date(:pboundaryinfo->update_time ,'yyyy-mm-dd hh24:mi:ss'),

                    trim(:pboundaryinfo->last_bid),

                    trim(:pboundaryinfo->next_bid),

                    :pboundaryinfo->sjsd,

                    :pboundaryinfo->tmis_station_no,

                    trim(:pboundaryinfo->tmis_station_name)

                    );

            if (sqlca.sqlcode != 0)

            {

                memset(temp,0,1024);

                sprintf(temp,"insert ap_train_cur_boundary,%s-%s,ORACLE返回值：%d\n",pboundaryinfo->t_type_id,pboundaryinfo->loco_no,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}



void update_Train_boundary_Status(pboundary_cur pboundaryinfo)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

        UPDATE ap_train_cur_boundary SET

            cc= trim(:pboundaryinfo->cc),                 /*VARCHAR2(10),*/

            driverno= :pboundaryinfo->driverno,           /*NUMBER(7),*/

            drivername= trim(:pboundaryinfo->drivername),         /*VARCHAR2(20),*/

            pass_boundary_time= to_date(:pboundaryinfo->pass_boundary_time ,'yyyy-mm-dd hh24:mi:ss'), /*LKJ DATE,*/

            update_time= to_date(:pboundaryinfo->update_time ,'yyyy-mm-dd hh24:mi:ss'),/*DATE,*/

            last_bid= trim(:pboundaryinfo->last_bid),           /*CHAR(2),*/

            next_bid= trim(:pboundaryinfo->next_bid),           /*CHAR(2),*/

            sjsd= :pboundaryinfo->sjsd,               /*NUMBER(8,2),*/

            tmis_station_no= :pboundaryinfo->tmis_station_no,    /*NUMBER(5),*/

            tmis_station_name= trim(:pboundaryinfo->tmis_station_name)  /*VARCHAR2(32)*/

            WHERE t_type_id = trim(:pboundaryinfo->t_type_id)

            AND loco_no=trim(:pboundaryinfo->loco_no);



            if (sqlca.sqlcode != 0)

            {

                memset(temp,0,1024);

                sprintf(temp,"ap_train_cur_boundary,%s-%s,ORACLE返回值：%d\n",pboundaryinfo->t_type_id,pboundaryinfo->loco_no,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}





/*add by guo 20160530*/

void update_Train_CRK(int crk)

{

    char temp[1024];



    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

        UPDATE AP_TRAIN_LASTSTATUS SET

            CRK= :crk

            WHERE t_type_id = trim(:data_event->T_TYPE_ID)

            AND loco_no=trim(:data_event->LOCO_NO);



            if (sqlca.sqlcode != 0)

            {

                memset(temp,0,1024);

                sprintf(temp,"AP_TRAIN_LASTSTATUS CRK,%s-%s,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

                lprintf(disp.e,temp);

                cclog('e',temp);

            }

}



/* add by guo 20160331 */

uchar insert_ap_train_laststatuslog(pboundary_info pboundaryinfo)

{

    char temp[256] = {0x00};

#if 1

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO AP_TRAIN_BOUNDARY_LOG (

                idx        ,

                t_type_id  ,

                loco_no    ,

                rksj       ,

                tmisno     ,

                tmisname   ,

                recordtime ,

                speed      ,

                cc         ,

                driverno   ,

                drivername ,

                direction/**/

                )

            VALUES(

                :pboundaryinfo->idx,

                trim(:pboundaryinfo->t_type_id),

                trim(:pboundaryinfo->loco_no),

                to_date(:pboundaryinfo->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                :pboundaryinfo->tmisno,

                trim(:pboundaryinfo->tmisname),

                to_date(:pboundaryinfo->recordtime ,'yyyy-mm-dd hh24:mi:ss'),

                :pboundaryinfo->speed,

                :pboundaryinfo->cc,

                :pboundaryinfo->driverno,

                trim(:pboundaryinfo->drivername),

                :pboundaryinfo->direction/**/

                );

#else

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO AP_TRAIN_BOUNDARY_LOG (

                idx        ,/*CHAR(32) not null,*/

                t_type_id  ,/*CHAR(3),*/

                loco_no    ,/*CHAR(4),*/

                rksj       ,/*DATE,*/

                tmisno     ,/*NUMBER(10),*/

                tmisname   ,/*VARCHAR2(32),*/

                recordtime ,/*DATE,*/

                speed      ,/*NUMBER(6,2),*/

                cc         ,/*VARCHAR2(21),*/

                driverno   ,/*NUMBER(10),*/

                drivername ,/*VARCHAR2(16),*/

                direction

                )

            VALUES(

                :pboundaryinfo->idx,

                :pboundaryinfo->t_type_id,

                :pboundaryinfo->loco_no,

                to_date(:pboundaryinfo->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                :pboundaryinfo->tmisno,

                :pboundaryinfo->tmisname,

                to_date(:pboundaryinfo->recordtime ,'yyyy-mm-dd hh24:mi:ss'),

                :pboundaryinfo->speed,

                :pboundaryinfo->cc,

                :pboundaryinfo->driverno,

                :pboundaryinfo->drivername,

                :pboundaryinfo->direction

                );

#endif

    if (sqlca.sqlcode == 0)

    {

        return 0;

    } else

    {

        sprintf(temp,"loco.%s-%s:AP_TRAIN_BOUNDARY_LOG,ORACLE返回值：%d\n",pboundaryinfo->t_type_id,pboundaryinfo->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);



        //printf("%s", temp);



        return 1;

    }

}



static unsigned char insert_to_ITF_6A_AV4()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_6A_AV4 (

                IDX       ,/*CHAR(32) not null,                  */

                T_TYPE_ID ,/*CHAR(3) not null,                   */

                LOCO_NO   ,/*CHAR(4) not null,                   */

                AB        ,/*NUMBER(1) default 0 not null,       */

                RKSJ      ,/*DATE,                               */

                BTSJ      ,/*DATE,                               */

                XTSJ      ,/*DATE,                               */

                ERR       ,/*NUMBER(3),                          */

                STA       /*NUMBER(3)                           */

                )

            VALUES(

                :data_3g->idx             ,/*CHAR(32) not null, */

                :data_3g->t_type_id   	,/*CHAR(3 CHAR),           */

                :data_3g->loco_no     	,/*CHAR(4 CHAR),           */

                :data_3g->ab          	,/*NUMBER(1),              */

                to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->str_6A.xtsj ,'yyyy-mm-dd hh24:mi:ss'), /*DATE,              */

                :data_3g->str_6a_lw.ERRLW            	,/*NUMBER(10,6),      */

                :data_3g->str_6a_lw.STA            	/*NUMBER(10,6),      */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:3Gt望信息入库失败,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_6A_DN()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_6A_DN (

                IDX       ,/*CHAR(32) not null,              */

                T_TYPE_ID ,/*CHAR(3) not null,               */

                LOCO_NO   ,/*CHAR(4) not null,               */

                AB        ,/*NUMBER(1) default 0 not null,   */

                RKSJ      ,/*DATE,                           */

                BTSJ      ,/*DATE,                           */

                XTSJ      ,/*DATE,                           */

                DY        ,/*NUMBER(10,3),                   */

                DL        ,/*NUMBER(10,3),                   */

                PL        ,/*NUMBER(10,3),                   */

                GLYS      ,/*NUMBER(10,3),                   */

                YGGL      ,/*NUMBER(10,3),                   */

                WGGL      ,/*NUMBER(10,3),                   */

                ZXYG      ,/*NUMBER(10,3),                   */

                FXYG      ,/*NUMBER(10,3),                   */

                ZXWG      ,/*NUMBER(10,3),                   */

                FXWG      /*NUMBER(10,3)                    */

                )

            VALUES(

                :data_3g->idx             ,/*CHAR(32) not null, */

                :data_3g->t_type_id   	,/*CHAR(3 CHAR),           */

                :data_3g->loco_no     	,/*CHAR(4 CHAR),           */

                :data_3g->ab          	,/*NUMBER(1),              */

                to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->str_6A.xtsj ,'yyyy-mm-dd hh24:mi:ss'), /*DATE,              */

                :data_3g->str_6a_dn.DY        ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.DL        ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.PL        ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.GLYS      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.YGGL      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.WGGL      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.ZXYG      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.FXYG      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.ZXWG      ,/*NUMBER(10,3),                   */

                :data_3g->str_6a_dn.FXWG      /*NUMBER(10,3)                    */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:3G电能信息入库失败,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_6A_YW()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_6A_YW (

                IDX       ,/*CHAR(32) not null,                 */

                T_TYPE_ID ,/*CHAR(3) not null,                  */

                LOCO_NO   ,/*CHAR(4) not null,                  */

                AB        ,/*NUMBER(1) default 0 not null,      */

                RKSJ      ,/*DATE,                              */

                BTSJ      ,/*DATE,                              */

                XTSJ      ,/*DATE,                              */

                YL        ,/*NUMBER(10),                        */

                YW        /*NUMBER(10)                         */

                )

            VALUES(

                :data_3g->idx             ,/*CHAR(32) not null, */

                :data_3g->t_type_id   	,/*CHAR(3 CHAR),           */

                :data_3g->loco_no     	,/*CHAR(4 CHAR),           */

                :data_3g->ab          	,/*NUMBER(1),              */

                to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->str_6A.xtsj ,'yyyy-mm-dd hh24:mi:ss'), /*DATE,              */

                :data_3g->str_6a_yw.YL            	,/*NUMBER(10,6),      */

                :data_3g->str_6a_yw.YW            	/*NUMBER(10,6),      */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:3G油位信息入库失败,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_LDP_SELFCHECK()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_LDP_SELFCHECK (

                IDX           ,/*CHAR(32) not null, */

                T_TYPE_ID     ,/*CHAR(3),           */

                LOCO_NO       ,/*CHAR(4),           */

                AB            ,/*NUMBER(1),         */

                BTSJ          ,/*DATE,              */

                VER           ,/*NUMBER(3),         */

                RKSJ          ,/*DATE,              */

                LDP_SJ        ,/*DATE,              */

                JD            ,/*NUMBER(10,6),      */

                WD            ,/*NUMBER(10,6),      */

                COMP          ,/*NUMBER(3),         */

                FHJLQCJ       ,/*NUMBER(3),         */

                LDP_XH        ,/*VARCHAR2(12),      */

                LDP_CCBH      ,/*VARCHAR2(12),      */

                LDP_CPU_VER   ,/*NUMBER(5,3),       */

                LDP_WXTX_VER  ,/*NUMBER(5,3),       */

                FHJLQ_VER     ,/*NUMBER(5,3),       */

                WLJKB_VER     ,/*NUMBER(5,3),       */

                BK_STATUS     ,/*NUMBER(5),         */

                TXZT          ,/*NUMBER(3),         */

                //WLANSSIDBB    ,

                SIMID         ,/*VARCHAR2(32),      */

                LL3GSY_M      ,/*NUMBER(5),         */

                LL3GSY_Y      ,/*NUMBER(5),         */

                LKJVER        ,/*VARCHAR2(20),      */

                VER6A         ,/*NUMBER(9),         */

                INTERVAL0     ,/*NUMBER(3),         */

                INTERVAL20    ,/*NUMBER(3),         */

                INTERVAL40    ,/*NUMBER(3),         */

                INTERVAL60    ,/*NUMBER(3),         */

                INTERVAL80    ,/*NUMBER(3),         */

                INTERVAL100   ,/*NUMBER(3),         */

                INTERVAL120   ,/*NUMBER(3),         */

                INTERVAL140   ,/*NUMBER(3),         */

                INTERVAL160   ,/*NUMBER(3),         */

                INTERVAL180   ,/*NUMBER(3),         */

                INTERVALOTHER ,/*NUMBER(3)          */

                LKJ_DATA_VER,/*LKJ数据版本*/

                FHJLQXLH,  /*防护记录器序列号*/

                LDPZCLQRJSJBB,/*LDP主处理器软件时间版本*/

                LDPWXTXBRJSJBB,/*LDP无线通信板软件时间版本*/

                FHJLQRJSJBB,/*防护记录器软件时间版本*/

                WLJKBRJSJBB,/*网络接口板软件时间版本*/

                BDBRJBB,/*北斗板软件版本*/

                BDBRJSJBB/*北斗板软件时间版本*/

                )

            VALUES(

                :data_3g->idx             ,/*CHAR(32) not null, */

                :data_3g->t_type_id   	,/*CHAR(3 CHAR),           */

                :data_3g->loco_no     	,/*CHAR(4 CHAR),           */

                :data_3g->ab          	,/*NUMBER(1),              */

                to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                :data_3g->str_self_check.VER,

                to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->str_self_check.LDP_SJ,'yyyy-mm-dd hh24:mi:ss'),

                :data_3g->str_datahead.JD            	,/*NUMBER(10,6),      */

                :data_3g->str_datahead.WD            	,/*NUMBER(10,6),      */

                :data_3g->str_self_check.COMP          ,/*NUMBER(3),         */

                :data_3g->str_self_check.FHJLQCJ       ,/*NUMBER(3),         */

                :data_3g->str_self_check.LDP_XH        ,/*VARCHAR2(12),      */

                :data_3g->str_self_check.LDP_CCBH      ,/*VARCHAR2(12),      */

                :data_3g->str_self_check.LDP_CPU_VER   ,/*NUMBER(5,3),       */

                :data_3g->str_self_check.LDP_WXTX_VER  ,/*NUMBER(5,3),       */

                :data_3g->str_self_check.FHJLQ_VER     ,/*NUMBER(5,3),       */

                :data_3g->str_self_check.WLJKB_VER     ,/*NUMBER(5,3),       */

                :data_3g->str_self_check.BK_STATUS     ,/*NUMBER(5),         */

                :data_3g->str_self_check.TXZT          ,/*NUMBER(3),         */

                //:data_3g->str_self_check.WLANSSIDBB    ,/**/

                //to_date(:data_3g->str_self_check.WLANSSIDBB,'yyyy-mm-dd hh24:mi:ss'),/*版本*/

                :data_3g->str_self_check.SIMID         ,/*VARCHAR2(32),      */

                :data_3g->str_self_check.LL3GSY_M      ,/*NUMBER(5),         */

                :data_3g->str_self_check.LL3GSY_Y      ,/*NUMBER(5),         */

                :data_3g->str_self_check.LKJVER        ,/*VARCHAR2(20),      */

                :data_3g->str_self_check.VER6A         ,/*NUMBER(9),         */

                :data_3g->str_self_check.INTERVAL0     ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL20    ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL40    ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL60    ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL80    ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL100   ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL120   ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL140   ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL160   ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVAL180   ,/*NUMBER(3),         */

                :data_3g->str_self_check.INTERVALOTHER ,/*NUMBER(3)*/

                :data_3g->str_self_check.LKJ_DATA_VER,/*LKJ数据版本*/

                :data_3g->str_self_check.FHJLQXLH,  /*防护记录器序列号*/

                trim(:data_3g->str_self_check.LDPZCLQRJSJBB),

                trim(:data_3g->str_self_check.LDPWXTXBRJSJBB),

                trim(:data_3g->str_self_check.FHJLQRJSJBB),

                trim(:data_3g->str_self_check.WLJKBRJSJBB),

                :data_3g->str_self_check.BDBRJBB,

                trim(:data_3g->str_self_check.BDBRJSJBB)

//                to_date(:data_3g->str_self_check.LDPZCLQRJSJBB,'yyyy-mm-dd hh24:mi:ss'),/*LDP主处理器软件时间版本*/

//                to_date(:data_3g->str_self_check.LDPWXTXBRJSJBB,'yyyy-mm-dd hh24:mi:ss'),/*LDP无线通信板软件时间版本*/

//                to_date(:data_3g->str_self_check.FHJLQRJSJBB,'yyyy-mm-dd hh24:mi:ss'),/*防护记录器软件时间版本*/

//                to_date(:data_3g->str_self_check.WLJKBRJSJBB,'yyyy-mm-dd hh24:mi:ss'),/*网络接口板软件时间版本*/

//                :data_3g->str_self_check.BDBRJBB,/*北斗板软件版本*/

//                to_date(:data_3g->str_self_check.BDBRJSJBB,'yyyy-mm-dd hh24:mi:ss')/*北斗板软件时间版本*/

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    } else

    {

        printf("FHJLQXLH = %s\n",data_3g->str_self_check.FHJLQXLH);

        printf("LDPZCLQRJSJBB = %s \n",data_3g->str_self_check.LDPZCLQRJSJBB);

        printf("LDPWXTXBRJSJBB = %s \n",data_3g->str_self_check.LDPWXTXBRJSJBB);

        printf("FHJLQRJSJBB = %s \n",data_3g->str_self_check.FHJLQRJSJBB);

        printf("WLJKBRJSJBB = %s \n",data_3g->str_self_check.WLJKBRJSJBB);

        printf("BDBRJSJBB = %s \n",data_3g->str_self_check.BDBRJSJBB);

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:3G自检信息入库失败,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_3G_HEADER()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_3G_HEADER (

                IDX       ,/*CHAR(32) not null,     */

                T_TYPE_ID ,/*CHAR(3),               */

                LOCO_NO   ,/*CHAR(4 CHAR),          */

                AB        ,/*NUMBER(1),             */

                BTSJ      ,/*DATE,                  */

                RKSJ      ,/*DATE default SYSDATE,  */

                XXLX      ,/*NUMBER(3),             */

                XXDJ      ,/*NUMBER(3),             */

                ZH        ,/*NUMBER(5),             */

                SJCD      ,/*NUMBER(5),             */

                FZBSH     ,/*NUMBER(3),             */

                FZH       ,/*NUMBER(3),             */

                JD        ,/*NUMBER(12,6),          */

                WD        ,/*NUMBER(12,6),          */

                SD        ,/*NUMBER(8,2),           */

                HB        ,/*NUMBER(8,2),           */

                LINENO    ,/*NUMBER(5),             */

                LINENAME  /*VARCHAR2(64)           */

                )

            VALUES(

                :data_3g->idx         ,/*CHAR(32 CHAR) not null,   */

                :data_3g->t_type_id   ,/*CHAR(3 CHAR),           */

                :data_3g->loco_no     ,/*CHAR(4 CHAR),           */

                :data_3g->ab          ,/*NUMBER(1),              */

                to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                :data_3g->str_datahead.XXLX      ,/*NUMBER(3),             */

                :data_3g->str_datahead.XXDJ      ,/*NUMBER(3),             */

                :data_3g->str_datahead.ZH        ,/*NUMBER(5),             */

                :data_3g->str_datahead.SJCD      ,/*NUMBER(5),             */

                :data_3g->str_datahead.FZBSH     ,/*NUMBER(3),             */

                :data_3g->str_datahead.FZH       ,/*NUMBER(3),             */

                :data_3g->str_datahead.JD        ,/*NUMBER(12,6),          */

                :data_3g->str_datahead.WD        ,/*NUMBER(12,6),          */

                :data_3g->str_datahead.SD        ,/*NUMBER(8,2),           */

                :data_3g->str_datahead.HB        ,/*NUMBER(8,2),           */

                :data_3g->str_datahead.LINENO    ,/*NUMBER(5),             */

                :data_3g->str_datahead.LINENAME  /*VARCHAR2(64)           */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        //printf("loco.%s-%s,rksj:%s,btsj:%s,ORACLE返回值:%d\n",data_3g->t_type_id,data_3g->loco_no,data_3g->rksj,data_3g->btsj,sqlca.sqlcode);

        /*printf("ab:%d,xxlx:%d,xxdj:%d,zh:%d,sjcd:%d,fzbsh:%d,fzh:%d,jd:%f,wd:%f,sd:%.2f,hb:%.2f,lineno:%d,linename:%s\n",

               data_3g->ab,data_3g->str_datahead.XXLX,data_3g->str_datahead.XXDJ,data_3g->str_datahead.ZH,data_3g->str_datahead.SJCD,

               data_3g->str_datahead.FZBSH,data_3g->str_datahead.FZH,data_3g->str_datahead.JD,data_3g->str_datahead.WD,data_3g->str_datahead.SD,

               data_3g->str_datahead.HB,data_3g->str_datahead.LINENO,data_3g->str_datahead.LINENAME);*/

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:3G包头信息入库失败,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.g,temp);

        cclog('e',temp);

        return 1;

    }

}


unsigned char update_ITF_6A()//6A报文
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_6A_LASTSTATUS SET 
             idx			= :data_3g->idx				,
             t_type_id		= :data_3g->t_type_id          , /*CHAR(3)*/
             loco_no		= :data_3g->loco_no             , /*CHAR(4)*/
             ab				= :data_3g->ab                  , /*NUMBER(1)*/
             rksj			= to_date(:data_3g->btsj,'yyyy-mm-dd hh24:mi:ss'), /*DATE*/
             btsj			= to_date(:data_3g->rksj,'yyyy-mm-dd hh24:mi:ss'), /*DATE*/
             xtsj			= to_date(:data_3g->str_6A.xtsj ,'yyyy-mm-dd hh24:mi:ss'), /*DATE*/

             xd_flag		= :data_3g->str_6A.xd_flag             , /*NUMBER(1)*/
             xd_simno		= :data_3g->str_6A.xd_simno            , /*VARCHAR2(12)*/
             xd_carno		= :data_3g->str_6A.xd_carno             ,/*VARCHAR2(16)*/
             xd_cenver		= :data_3g->str_6A.xd_cenver           , /*NUMBER(1,2)*/

             zd_flag		= :data_3g->str_6A.zd_flag             , /*NUMBER(1)*/
             zd_alt	    = :data_3g->str_6A.str_6azd.zd_alt              , /*NUMBER(3)*/
             zd_cnt     = :data_3g->str_6A.str_6azd.zd_cnt              , /*NUMBER(3)*/
             zd_lcg     = :data_3g->str_6A.str_6azd.zd_lcg              , /*NUMBER(6)*/
             zd_tfg     = :data_3g->str_6A.str_6azd.zd_tfg              , /*NUMBER(6)*/
             zd_jhg     = :data_3g->str_6A.str_6azd.zd_jhg              , /*NUMBER(6)*/
             zd_llj     = :data_3g->str_6A.str_6azd.zd_llj              , /*NUMBER(6)*/
             zd_speed   = :data_3g->str_6A.str_6azd.zd_speed            ,/*NUMBER(6)*/
             jy_flag    = :data_3g->str_6A.jy_flag             , /*NUMBER(1)*/

             jy_jcdy    = :data_3g->str_6A.str_6ajy.jy_jcdy             , /*NUMBER(5)*/
             jy_mxdy    = :data_3g->str_6A.str_6ajy.jy_mxdy             , /*NUMBER(5)*/
             jy_bjzt    = :data_3g->str_6A.str_6ajy.jy_bjzt             , /*NUMBER(3)*/
             jy_cszt    = :data_3g->str_6A.str_6ajy.jy_cszt             , /*NUMBER(3)*/
             jy_zjgz    = :data_3g->str_6A.str_6ajy.jy_zjgz             , /*NUMBER(3)*/
             sp_flag    = :data_3g->str_6A.sp_flag             , /*NUMBER(1)*/

             sp_cjkgz_1 = :data_3g->str_6A.str_6asp.sp_cjkgz_1          , /*NUMBER(3)*/
             sp_cjkgz_2 = :data_3g->str_6A.str_6asp.sp_cjkgz_2          , /*NUMBER(3)*/
             sp_ccbgz   = :data_3g->str_6A.str_6asp.sp_ccbgz            , /*NUMBER(3)*/
             sp_tdzjgz  = hextoraw(:data_3g->str_6A.str_6asp.sp_tdzjgz)            ,

             zx_flag    = :data_3g->str_6A.zx_flag             , /*NUMBER(1)*/
             zx_wd_1    = hextoraw(:data_3g->str_6A.str_6azx[0].zx_wd )            , /*RAW(8)*/
             zx_bj_1    = hextoraw(:data_3g->str_6A.str_6azx[0].zx_bj )           , /*RAW(8)*/
             zx_hw1_1   = :data_3g->str_6A.str_6azx[0].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_1   = :data_3g->str_6A.str_6azx[0].zx_hw2            , /*NUMBER(4)*/
             zx_qzclqstate_1    = :data_3g->str_6A.str_6azx[0].zx_qzclqstate     , /*NUMBER(3)*/
             zx_sdmc_1  = :data_3g->str_6A.str_6azx[0].zx_sdmc            ,/*NUMBER(5)*/
             zx_wd_2    = hextoraw(:data_3g->str_6A.str_6azx[1].zx_wd)             , /*RAW(8)*/
             zx_bj_2    = hextoraw(:data_3g->str_6A.str_6azx[1].zx_bj)              ,/*RAW(8)*/
             zx_hw1_2   = :data_3g->str_6A.str_6azx[1].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_2   = :data_3g->str_6A.str_6azx[1].zx_hw2            , /*NUMBER(4)*/
             zx_qzclqstate_2    = :data_3g->str_6A.str_6azx[1].zx_qzclqstate     , /*NUMBER(3)*/
             zx_sdmc_2  = :data_3g->str_6A.str_6azx[1].zx_sdmc           , /*NUMBER(5)*/
             zx_wd_3    = hextoraw(:data_3g->str_6A.str_6azx[2].zx_wd)             , /*RAW(8)*/
             zx_bj_3    = hextoraw(:data_3g->str_6A.str_6azx[2].zx_bj)             , /*RAW(8)*/
             zx_hw1_3   = :data_3g->str_6A.str_6azx[2].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_3   = :data_3g->str_6A.str_6azx[2].zx_hw2            , /*NUMBER(4)*/
             zx_qzclqstate_3    = :data_3g->str_6A.str_6azx[2].zx_qzclqstate     , /*INTEGER*/
             zx_sdmc_3  = :data_3g->str_6A.str_6azx[2].zx_sdmc           , /*NUMBER(5)*/
             zx_wd_4    = hextoraw(:data_3g->str_6A.str_6azx[3].zx_wd)             , /*RAW(8)*/
             zx_bj_4    = hextoraw(:data_3g->str_6A.str_6azx[3].zx_bj)             , /*RAW(8)*/
             zx_hw1_4   = :data_3g->str_6A.str_6azx[3].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_4   = :data_3g->str_6A.str_6azx[3].zx_hw2            , /*NUMBER(4)*/
             zx_qzclqstate_4    = :data_3g->str_6A.str_6azx[3].zx_qzclqstate     , /*INTEGER*/
             zx_sdmc_4  = :data_3g->str_6A.str_6azx[3].zx_sdmc           , /*NUMBER(5)*/
             zx_wd_5    = hextoraw(:data_3g->str_6A.str_6azx[4].zx_wd)             , /*RAW(8)*/
             zx_bj_5    = hextoraw(:data_3g->str_6A.str_6azx[4].zx_bj)             , /*RAW(8)*/
             zx_hw1_5   = :data_3g->str_6A.str_6azx[4].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_5   = :data_3g->str_6A.str_6azx[4].zx_hw2            , /*NUMBER(4)*/
             zx_qzclqstate_5    = :data_3g->str_6A.str_6azx[4].zx_qzclqstate     , /*NUMBER(3)*/
             zx_sdmc_5  = :data_3g->str_6A.str_6azx[4].zx_sdmc           , /*NUMBER(5)*/
             zx_wd_6    = hextoraw(:data_3g->str_6A.str_6azx[5].zx_wd)             , /*RAW(8)*/
             zx_bj_6    = hextoraw(:data_3g->str_6A.str_6azx[5].zx_bj)             , /*RAW(8)*/
             zx_hw1_6   = :data_3g->str_6A.str_6azx[5].zx_hw1            , /*NUMBER(4)*/
             zx_hw2_6   = :data_3g->str_6A.str_6azx[5].zx_hw2           , /*NUMBER(4)*/
             zx_qzclqstate_6    = :data_3g->str_6A.str_6azx[5].zx_qzclqstate     , /*NUMBER(3)*/
             zx_sdmc_6  = :data_3g->str_6A.str_6azx[5].zx_sdmc           , /*NUMBER(5)*/

             lg_flag    = :data_3g->str_6A.lg_flag                      , /*NUMBER(1)*/
             lg_ldl_1   = :data_3g->str_6A.str_6alg.lg_ldl_1            , /*NUMBER(11)*/
             lg_ydl_1   = :data_3g->str_6A.str_6alg.lg_ydl_1            , /*NUMBER(11)*/
             lg_srdy_1  = :data_3g->str_6A.str_6alg.lg_srdy_1           , /*NUMBER(11)*/
             lg_srdl_1  = :data_3g->str_6A.str_6alg.lg_srdl_1           , /*NUMBER(11)*/
             lg_scdy_1  = :data_3g->str_6A.str_6alg.lg_scdy_1           , /*NUMBER(11)*/
             lg_scdl_1  = :data_3g->str_6A.str_6alg.lg_scdl_1           , /*NUMBER(11)*/
             lg_bdy_1   = :data_3g->str_6A.str_6alg.lg_bdy_1            , /*NUMBER(11)*/
             lg_ldl_2   = :data_3g->str_6A.str_6alg.lg_ldl_2            , /*NUMBER(11)*/
             lg_ydl_2   = :data_3g->str_6A.str_6alg.lg_ydl_2            , /*NUMBER(11)*/
             lg_srdy_2  = :data_3g->str_6A.str_6alg.lg_srdy_2           , /*NUMBER(11)*/
             lg_srdl_2  = :data_3g->str_6A.str_6alg.lg_srdl_2           , /*NUMBER(11)*/
             lg_scdy_2  = :data_3g->str_6A.str_6alg.lg_scdy_2           , /*NUMBER(11)*/
             lg_scdl_2  = :data_3g->str_6A.str_6alg.lg_scdl_2           , /*NUMBER(11)*/
             lg_bdy_2   = :data_3g->str_6A.str_6alg.lg_bdy_2            , /*NUMBER(11)*/
             lg_err     = hextoraw(:data_3g->str_6A.str_6alg.lg_err)              , /*RAW(4)*/
             lg_sta     = hextoraw(:data_3g->str_6A.str_6alg.lg_sta)              , /*RAW(4)*/
             lg_kgl     = :data_3g->str_6A.str_6alg.lg_kgl              , /*NUMBER(3)*/

             fh_flag    = :data_3g->str_6A.fh_flag                      , /*NUMBER(1)*/
             fh_zxkl    = :data_3g->str_6A.str_6afh.fh_zxkl             , /*NUMBER(3)*/
             fh_zxdl    = :data_3g->str_6A.str_6afh.fh_zxdl             , /*NUMBER(3)*/
             fh_ttzt    = hextoraw(:data_3g->str_6A.str_6afh.fh_ttzt)             , /*RAW(32)*/
             fh_ttlx    =  hextoraw(:data_3g->str_6A.str_6afh.fh_ttlx)               /*RAW(32)*/;

    if (sqlca.sqlcode == 0)
    {
        //printf("6A update success!\n");
        return 0;
    }
    else
    {
        memset(temp,0,1024);
		sprintf(temp,"loco.%s-%s:3G6A信息 update failed !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);
        lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }
}



unsigned char update_ITF_TAXV10()//TAX V1.O
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;	
    EXEC SQL UPDATE AP_TAX_LASTSTATUS SET 
               idx		  = :data_3g->idx				,
               t_type_id  = :data_3g->t_type_id   ,
               loco_no	  = :data_3g->loco_no     ,
               tax_ver    = :data_3g->tax_ver         ,
               ab		  = :data_3g->ab          ,
               btsj		  = to_date(:data_3g->btsj,'yyyy-mm-dd hh24:mi:ss'),
               rksj		  = to_date(:data_3g->rksj,'yyyy-mm-dd hh24:mi:ss'),
               xtsj		  = to_date(:data_3g->str_tax.xtsj ,'yyyy-mm-dd hh24:mi:ss'),

               cc			= :data_3g->str_tax.cc          ,
               czh			= :data_3g->str_tax.czh         ,
               sjh			= :data_3g->str_tax.sjh         ,
               fsjh			= :data_3g->str_tax.fsjh        ,
               sjjlh		= :data_3g->str_tax.sjjlh       ,
               kh			= :data_3g->str_tax.kh          ,
               bb			= :data_3g->str_tax.bb          ,
               sjsu			= :data_3g->str_tax.sjsu        ,
               jcxh			= :data_3g->str_tax.jcxh        ,
               gk			= :data_3g->str_tax.gk          ,
               xhjbh		= :data_3g->str_tax.xhjbh       ,
               xhjlb		= :data_3g->str_tax.xhjlb       ,
               glb			= :data_3g->str_tax.glb         ,
               zz			= :data_3g->str_tax.zz          ,
               jc			= :data_3g->str_tax.jc          ,
               ls			= :data_3g->str_tax.ls          ,
               lcgyl		= :data_3g->str_tax.lcgyl       ,
               zzzt			= :data_3g->str_tax.zzzt        ,				
               stationname  = trim(:data_3g->str_tax.stationname) ,
               drivername   = trim(:data_3g->str_tax.drivername)  ,
               fdrivername  = trim(:data_3g->str_tax.fdrivername);

    if (sqlca.sqlcode == 0)
    {
        //printf("TAXV1.0 update success!!\n");
        return 0;
    }
    else
    {
        memset(temp,0,1024);
        sprintf(temp,"loco.%s-%s:TAX v1.0信息 update failed !!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no,sqlca.sqlcode);	
		lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }
}

unsigned char update_ITF_TAXV2X()//TAX V2.O V2.1
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_TAX_LASTSTATUS SET 

               idx			= :data_3g->idx				,
               t_type_id	= :data_3g->t_type_id   ,
               loco_no		= :data_3g->loco_no     ,
               tax_ver		= :data_3g->tax_ver         ,
               ab			= :data_3g->ab          ,
               btsj			= to_date(:data_3g->btsj,'yyyy-mm-dd hh24:mi:ss'),
               rksj			= to_date(:data_3g->rksj,'yyyy-mm-dd hh24:mi:ss'),
               xtsj			= to_date(:data_3g->str_tax.xtsj ,'yyyy-mm-dd hh24:mi:ss'),

               cc		= :data_3g->str_tax.cc          ,
               czh		= :data_3g->str_tax.czh         ,
               sjh		= :data_3g->str_tax.sjh         ,
               fsjh		= :data_3g->str_tax.fsjh        ,
               sjjlh	= :data_3g->str_tax.sjjlh       ,
               kh		= :data_3g->str_tax.kh          ,
               bb		= :data_3g->str_tax.bb          ,
               sjsu		= :data_3g->str_tax.sjsu        ,
               jcxh		= :data_3g->str_tax.jcxh        ,
               gk		= :data_3g->str_tax.gk          ,
               xhjbh	= :data_3g->str_tax.xhjbh       ,
               xhjlb	= :data_3g->str_tax.xhjlb       ,
               glb		= :data_3g->str_tax.glb         ,
               zz		= :data_3g->str_tax.zz          ,
               jc		= :data_3g->str_tax.jc          ,
               ls		= :data_3g->str_tax.ls          ,
               lcgyl	= :data_3g->str_tax.lcgyl       ,
               zzzt		= :data_3g->str_tax.zzzt        ,
              srjlh		= :data_3g->str_tax.srjlh       ,
              jlqfxhjjl = :data_3g->str_tax.jlqfxhjjl   ,
              xs		= :data_3g->str_tax.xs          ,
              zdsc		= :data_3g->str_tax.zdsc        ,
              dqxlhbz   = :data_3g->str_tax.dqxlhbz     ,
              dqxlh		= :data_3g->str_tax.dqxlh       ,
              qfxlhbz   = :data_3g->str_tax.qfxlhbz     ,
              qfxlh		= :data_3g->str_tax.qfxlh       ,
              dq_tmis   = :data_3g->str_tax.dq_tmis     ,
              qf_time   = :data_3g->str_tax.qf_time     ,
              qfczjlh   = :data_3g->str_tax.qfczjlh     ,
              qfchzh	= :data_3g->str_tax.qfchzh      ,
              jkzt		= :data_3g->str_tax.jkzt        ,
              ljwy		= :data_3g->str_tax.ljwy        ,
              bfqzx		= :data_3g->str_tax.bfqzx       ,
              bfqcx		= :data_3g->str_tax.bfqcx       ,
              qffqzx	= :data_3g->str_tax.qffqzx      ,
              qffqcx	= :data_3g->str_tax.qffqcx      ,
              stationname   = trim(:data_3g->str_tax.stationname) ,
              drivername	= trim(:data_3g->str_tax.drivername)  ,
              fdrivername   = trim(:data_3g->str_tax.fdrivername) ,
              lkj_type		= :data_3g->str_tax.lkj_type;

    if (sqlca.sqlcode == 0)
    {
        //		memset(temp,0,1024);
        //		sprintf(temp,"loco.%s-%s:TAXV2.0 update success !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        //		lprintf(disp.e,temp);
        //		lprintf(disp.v,temp);
        //		cclog('e',temp);
		
        //printf("TAXV2.0 update success!!\n");

        return 0;
    }
    else
    {
        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:TAXV2.0 update failed !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }	
}



unsigned char update_ITF_TCMS_HXD_V20()//电力机车TCMS2.0
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_TCMS_HXD_V20_LASTSTATUS SET 

              idx		=  :data_3g->idx               ,/*CHAR(32 CHAR) not null,        */
              t_type_id =  :data_3g->t_type_id          ,/*CHAR(3) not null,                */
              loco_no   =  :data_3g->loco_no            ,/*CHAR(4) not null,                */
              ab		=  :data_3g->ab                 ,/*NUMBER(1) default 0 not null,    */
              btsj		=  to_date(:data_3g->btsj,'yyyy-mm-dd hh24:mi:ss'),
              rksj		=  to_date(:data_3g->rksj,'yyyy-mm-dd hh24:mi:ss'),
              tcms_xtsj =  to_date(:data_3g->tcms_xtsj ,'yyyy-mm-dd hh24:mi:ss'),
              tcms_ver  =  :data_3g->tcms_ver                ,/*NUMBER(3) default 10 not null,   */

              yx_st5		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st5             ,/*NUMBER(3)*/
              yx_st6		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st6             ,/*NUMBER(3)*/
              yx_st7		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st7             ,/*NUMBER(3) */
              yx_st8		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st8             ,/*NUMBER(3)*/
              yx_st9		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st9             ,/*NUMBER(3)*/
              yx_st10		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st10            ,/*NUMBER(3)*/
              yx_st11		=  :data_3g->str_tcms_dl_v20.str_basic.yx_st11            ,/*NUMBER(3)*/
              yx_sbjw		=  :data_3g->str_tcms_dl_v20.str_basic.yx_sbjw            ,/*NUMBER(6,1)*/
              yx_sd_jh		=  :data_3g->str_tcms_dl_v20.str_basic.yx_sd_jh           ,/*NUMBER(6,1)*/
              yx_sd_sj		=  :data_3g->str_tcms_dl_v20.str_basic.yx_sd_sj           ,/*NUMBER(6,1)*/
              yx_ybdy		=  :data_3g->str_tcms_dl_v20.str_basic.yx_ybdy            ,/*NUMBER(5)*/
              yx_ybdl		=  :data_3g->str_tcms_dl_v20.str_basic.yx_ybdl            ,/*NUMBER(5)*/
              yx_zfgyl		=  :data_3g->str_tcms_dl_v20.str_basic.yx_zfgyl           ,/*NUMBER(5)*/
              yx_jhfgyl		=  :data_3g->str_tcms_dl_v20.str_basic.yx_jhfgyl          ,/*NUMBER(5) */
              yx_lcgyl		=  :data_3g->str_tcms_dl_v20.str_basic.yx_lcgyl           ,/*NUMBER(5) */
              yx_zdfg1yl    =  :data_3g->str_tcms_dl_v20.str_basic.yx_zdfg1yl         ,/*NUMBER(4)*/
              yx_zdfg2yl    =  :data_3g->str_tcms_dl_v20.str_basic.yx_zdfg2yl         ,/*NUMBER(4) */
              yx_zlc		=  :data_3g->str_tcms_dl_v20.str_basic.yx_zlc             ,/*NUMBER(10)*/
              yx_xdcyl		=  :data_3g->str_tcms_dl_v20.str_basic.yx_xdcyl           ,/*NUMBER(3)*/
              yx_zdlqdzcs   =  :data_3g->str_tcms_dl_v20.str_basic.yx_zdlqdzcs        ,/*NUMBER(10)*/
              yx_ysj1yxsj   =  :data_3g->str_tcms_dl_v20.str_basic.yx_ysj1yxsj        ,/*NUMBER(10,1)*/
              yx_ysj2yxsj   =  :data_3g->str_tcms_dl_v20.str_basic.yx_ysj2yxsj        ,/*NUMBER(10,1)*/

              qy_cdjcq		=  :data_3g->str_tcms_dl_v20.str_qianyin.qy_cdjcq           ,/*NUMBER(3)*/
              qy_djjcq		=  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djjcq           ,/*NUMBER(3)*/
              qy_zgl		=  :data_3g->str_tcms_dl_v20.str_qianyin.qy_zgl             ,/*NUMBER(3)*/
              qy_sdsd		=  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sdsd            ,/*NUMBER(5,1)*/
              qy_sjsd		=  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd            ,/*NUMBER(5,1)*
              qy_qyzdlsdz_1bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_1bg1mt ,/*NUMBER(5,1) */
              qy_qyzdlsdz_1bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_1bg2mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_1bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_1bg3mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_2bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_2bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_2bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_2bg2mt ,/*NUMBER(5,1) */
              qy_qyzdlsdz_2bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsdz_2bg3mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_1bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_1bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_1bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_1bg2mt ,/*NUMBER(5,1) */
              qy_qyzdlsjz_1bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_1bg3mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_2bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_2bg1mt ,/*NUMBER(5,1) */
              qy_qyzdlsjz_2bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_2bg2mt ,/*NUMBER(5,1),*/
              qy_qyzdlsjz_2bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyzdlsjz_2bg3mt ,/*NUMBER(5,1),*/
              qy_sjsd_1bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_1bg1mt     ,/*NUMBER(5,1),*/
              qy_sjsd_1bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_1bg2mt     ,/*NUMBER(5,1),*/
              qy_sjsd_1bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_1bg3mt     ,/*NUMBER(5,1),*/
              qy_sjsd_2bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_2bg1mt     ,/*NUMBER(5,1), */
              qy_sjsd_2bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_2bg2mt     ,/*NUMBER(5,1),*/
              qy_sjsd_2bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_sjsd_2bg3mt     ,/*NUMBER(5,1),*/
              qy_djdl_1bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_1bg1mt     ,/*NUMBER(5), */
              qy_djdl_1bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_1bg2mt     ,/*NUMBER(5),*/
              qy_djdl_1bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_1bg3mt     ,/*NUMBER(5),*/
              qy_djdl_2bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_2bg1mt     ,/*NUMBER(5),*/
              qy_djdl_2bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_2bg2mt     ,/*NUMBER(5), */
              qy_djdl_2bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djdl_2bg3mt     ,/*NUMBER(5),*/
              qy_djwd_1bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_1bg1mt     ,/*NUMBER(4),*/
              qy_djwd_1bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_1bg2mt     ,/*NUMBER(4),*/
              qy_djwd_1bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_1bg3mt     ,/*NUMBER(4),*/
              qy_djwd_2bg1mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_2bg1mt     ,/*NUMBER(4),*/
              qy_djwd_2bg2mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_2bg2mt     ,/*NUMBER(4), */
              qy_djwd_2bg3mt    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_djwd_2bg3mt     ,/*NUMBER(4),*/
              qy_fdjdy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_fdjdy           ,/*NUMBER(5),*/
              qy_fdjdl    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_fdjdl           ,/*NUMBER(5),*/
              qy_jlqzlmx1dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx1dy      ,/*NUMBER(5),*/
              qy_jlqzlmx2dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx2dy      ,/*NUMBER(5),*/
              qy_jlqzlmx3dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx3dy      ,/*NUMBER(5),*/
              qy_jlqzlmx4dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx4dy      ,/*NUMBER(5),*/
              qy_jlqzlmx5dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx5dy      ,/*NUMBER(5),*/
              qy_jlqzlmx6dy    =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_jlqzlmx6dy      ,/*NUMBER(5),*/
              qy_qyblqlqsyl1   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl1     ,/*NUMBER(5,2),*/
              qy_qyblqlqsyl2   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl2     ,/*NUMBER(5,2),*/
              qy_qyblqlqsyl3   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl3     ,/*NUMBER(5,2),*/
              qy_qyblqlqsyl4   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl4     ,/*NUMBER(5,2),*/
              qy_qyblqlqsyl5   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl5     ,/*NUMBER(5,2), */
              qy_qyblqlqsyl6   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqsyl6     ,/*NUMBER(5,2),*/
              qy_qyblqlqswd1   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd1     ,/*NUMBER(6),*/
              qy_qyblqlqswd2   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd2     ,/*NUMBER(6), */
              qy_qyblqlqswd3   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd3     ,/*NUMBER(6),*/
              qy_qyblqlqswd4   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd4     ,/*NUMBER(6),*/
              qy_qyblqlqswd5   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd5     ,/*NUMBER(6),*/
              qy_qyblqlqswd6   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qyblqlqswd6     ,/*NUMBER(6),*/
              qy_qybyqyw1	   =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qybyqyw1        ,/*NUMBER(6),*/
              qy_qybyqyw2      =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qybyqyw2        ,/*NUMBER(6),*/
              qy_qybyqyw3      =  :data_3g->str_tcms_dl_v20.str_qianyin.qy_qybyqyw3        ,/*NUMBER(6),*/

              fz_fzblqzczt		=  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblqzczt       ,/*NUMBER(3), */
              fz_qyfjsxdlqjqqzt =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_qyfjsxdlqjqqzt  ,/*NUMBER(3), */
              fz_st7			=  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_st7             ,/*NUMBER(3), */
              fz_ybsxdlqzt		=  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_ybsxdlqzt       ,/*NUMBER(3), */
              fz_blqsbsxdlqzt	=  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_blqsbsxdlqzt    ,/*NUMBER(3),*/
              fz_ysjgz		 =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_ysjgz           ,/*NUMBER(3),*/
              fz_fzblq1_scdy =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq1_scdy     ,/*NUMBER(5), */
              fz_fzblq1_scdl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq1_scdl     ,/*NUMBER(5),*/
              fz_fzblq1_scpl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq1_scpl     ,/*NUMBER(5),*/
              fz_fzblq2_scdy =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq2_scdy     ,/*NUMBER(5),*/
              fz_fzblq2_scdl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq2_scdl     ,/*NUMBER(5),*/
              fz_fzblq2_scpl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq2_scpl     ,/*NUMBER(5),*/
              fz_fzblq3_scdy =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq3_scdy     ,/*NUMBER(5),*/
              fz_fzblq3_scdl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq3_scdl     ,/*NUMBER(5),*/
              fz_fzblq3_scpl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq3_scpl     ,/*NUMBER(5),*/
              fz_fzblq4_scdy =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq4_scdy     ,/*NUMBER(5),*/
              fz_fzblq4_scdl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq4_scdl     ,/*NUMBER(5),*/
              fz_fzblq4_scpl =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_fzblq4_scpl     ,/*NUMBER(5),*/
              fz_lg1_scdy    =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_lg1_scdy        ,/*NUMBER(5),*/
              fz_lg1_scdl    =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_lg1_scdl        ,/*NUMBER(5), */
              fz_lg2_scdy    =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_lg2_scdy        ,/*NUMBER(5),*/
              fz_lg2_scdl    =  :data_3g->str_tcms_dl_v20.str_fuzhu.fz_lg2_scdl        ,/*NUMBER(5),*/

              zd_sdsd    =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_sdsd            ,/*NUMBER(6,1),*/
              zd_sjsd    =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_sjsd            ,/*NUMBER(6,1), */
              zd_abh     =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_abh             ,/*NUMBER(3),*/
              zd_ibh     =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_ibh             ,/*NUMBER(3),*/
              zd_zdsj    =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_zdsj            ,/*NUMBER(3), */
              zd_zdj     =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_zdj             ,/*NUMBER(3),*/
              zd_st9     =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_st9             ,/*NUMBER(3),*/
              zd_zfgyl   =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_zfgyl           ,/*NUMBER(5),*/
              zd_jhfgyl  =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_jhfgyl          ,/*NUMBER(5),*/
              zd_lcgyl   =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_lcgyl           ,/*NUMBER(5),*/
              zd_zdfg1yl =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_zdfg1yl         ,/*NUMBER(5),*/
              zd_zdfg2yl =  :data_3g->str_tcms_dl_v20.str_zhidong.zd_zdfg2yl         ,/*NUMBER(5), */

              bbxx_jcyxlc		=  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_jcyxlc        ,/*NUMBER(10),*/
              bbxx_zdlqdzcs		=  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_zdlqdzcs      ,/*NUMBER(10),*/
              bbxx_ysj1_yxljsj  =  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_ysj1_yxljsj   ,/*NUMBER(10,1),*/
              bbxx_ysj2_yxljsj  =  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_ysj2_yxljsj   ,/*NUMBER(10,1),*/
              bbxx_tcms_zkdybb1 =  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_tcms_zkdybb1  ,/*NUMBER(10),*/
              bbxx_tcms_zkdybb2 =  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_tcms_zkdybb2  ,/*NUMBER(10),                      */
              bbxx_wgdybb1		=  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_wgdybb1       ,/*NUMBER(10),*/
              bbxx_wgdybb2		=  :data_3g->str_tcms_dl_v20.str_ljlybbxx.bbxx_wgdybb2        /*NUMBER(10) */;

    if (sqlca.sqlcode == 0)
    {
        //			memset(temp,0,1024);

        //			sprintf(temp,"loco.%s-%s:电力机车V2.0 update sucess!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        //			lprintf(disp.e,temp);
        //			lprintf(disp.v,temp);
        //			cclog('e',temp);

        return 0;
    }
    else
    {
        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:电力机车V2.0 update failed!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }
}

unsigned char update_ITF_TCMS_HXN_V20()//内燃机车
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_TCMS_HXN_V20_LASTSTATUS SET 

              idx			=  :data_3g->idx                 ,/*CHAR(32) not null*/
              t_type_id		=  :data_3g->t_type_id            ,/*CHAR(3) not null*/
              loco_no		=  :data_3g->loco_no              ,/*CHAR(4) not null*/
              ab			=  :data_3g->ab                   ,/*NUMBER(1) default 0 not null*/
              btsj			=  to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),
              rksj			=  to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),
              tcms_xtsj		=  to_date(:data_3g->tcms_xtsj ,'yyyy-mm-dd hh24:mi:ss'),
              tcms_ver		=  :data_3g->tcms_ver               ,/*NUMBER(3)*/

              zd_st5		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_st5               ,/*NUMBER(3)*/
              zd_zdsbwz		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_zdsbwz            ,/*NUMBER(3)*/
              zd_ddsbwz		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_ddsbwz            ,/*NUMBER(3)*/
              zd_zdjzdsj    =  :data_3g->str_tcms_nr_v20.str_zhidong.zd_zdjzdsj           ,/*NUMBER(3)*/
              zd_st9		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_st9               ,/*NUMBER(3)*/
              zd_tfzd		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_tfzd              ,/*NUMBER(3)*/
              zd_zfgyl		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_zfgyl             ,/*NUMBER(5)*/
              zd_jhfgyl		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_jhfgyl            ,/*NUMBER(5)*/
              zd_lcgyl		=  :data_3g->str_tcms_nr_v20.str_zhidong.zd_lcgyl             ,/*NUMBER(5)*/
              zd_zdfg1yl    =  :data_3g->str_tcms_nr_v20.str_zhidong.zd_zdfg1yl           ,/*NUMBER(5)*/
              zd_zdfg2yl    =  :data_3g->str_tcms_nr_v20.str_zhidong.zd_zdfg2yl          , /*NUMBER(5)*/
              
			  yx_czd		=  :data_3g->str_tcms_nr_v20.str_basic.yx_czd               ,/*NUMBER(3)*/
              yx_fxsb		=  :data_3g->str_tcms_nr_v20.str_basic.yx_fxsb              ,/*NUMBER(3)*/
              yx_jcgk		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jcgk              ,/*NUMBER(3)*/
              yx_xsqjm		=  :data_3g->str_tcms_nr_v20.str_basic.yx_xsqjm             ,/*NUMBER(3)*/
              yx_st9		=  :data_3g->str_tcms_nr_v20.str_basic.yx_st9               ,/*NUMBER(3)*/
              yx_wrjt		=  :data_3g->str_tcms_nr_v20.str_basic.yx_wrjt              ,/*NUMBER(3)*/
              yx_st11		=  :data_3g->str_tcms_nr_v20.str_basic.yx_st11              ,/*NUMBER(3)*/
              yx_skqsbdw    =  :data_3g->str_tcms_nr_v20.str_basic.yx_skqsbdw           ,/*NUMBER(3)*/
              yx_cyjsczgl   =  :data_3g->str_tcms_nr_v20.str_basic.yx_cyjsczgl          ,/*NUMBER(5)*/
              yx_zfgl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_zfgl              ,/*NUMBER(5)*/
              yx_fzfdjgl    =  :data_3g->str_tcms_nr_v20.str_basic.yx_fzfdjgl           ,/*NUMBER(5)*/
              yx_zfhgl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_zfhgl             ,/*NUMBER(5)*/
              yx_jcyxsd		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jcyxsd            ,/*NUMBER(5,1)*/
              yx_jcqyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jcqyl             ,/*NUMBER(5)*/
              yx_jczdl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jczdl             ,/*NUMBER(5)*/
              yx_dqyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_dqyl              ,/*NUMBER(5)*/
              yx_hjwd		=  :data_3g->str_tcms_nr_v20.str_basic.yx_hjwd              ,/*NUMBER(5,1)*/
              yx_ryyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_ryyl              ,/*NUMBER(5)*/
              yx_ryyw		=  :data_3g->str_tcms_nr_v20.str_basic.yx_ryyw              ,/*NUMBER(5)*/
              yx_xdcdy		=  :data_3g->str_tcms_nr_v20.str_basic.yx_xdcdy             ,/*NUMBER(5,1)*/
              yx_xdccddl    =  :data_3g->str_tcms_nr_v20.str_basic.yx_xdccddl           ,/*NUMBER(5)*/
              yx_zfgyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_zfgyl             ,/*NUMBER(5)*/
              yx_jhfgyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jhfgyl            ,/*NUMBER(5)*/
              yx_lcgyl		=  :data_3g->str_tcms_nr_v20.str_basic.yx_lcgyl             ,/*NUMBER(5)*/
              yx_zdfg1yl    =  :data_3g->str_tcms_nr_v20.str_basic.yx_zdfg1yl           ,/*NUMBER(5)*/
              yx_zdfg2yl    =  :data_3g->str_tcms_nr_v20.str_basic.yx_zdfg2yl           ,/*NUMBER(5)*/
              yx_cyjzs		=  :data_3g->str_tcms_nr_v20.str_basic.yx_cyjzs             ,/*NUMBER(5)*/
              yx_jcyxlc		=  :data_3g->str_tcms_nr_v20.str_basic.yx_jcyxlc            ,/*NUMBER(10)*/
              
			  cyj_st5		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_st5              ,/*NUMBER(3)*/
              cyj_st6		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_st6              ,/*NUMBER(3)*/
              cyj_st7		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_st7              ,/*NUMBER(3)*/
              cyj_st8		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_st8              ,/*NUMBER(3)*/
              cyj_zs		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_zs               ,/*NUMBER(5)*/
              cyj_qzxyl1    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_qzxyl1           ,/*NUMBER(5,1)*/
              cyj_qzxyl2    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_qzxyl2           ,/*NUMBER(5,1)*/
              cyj_kqxwyxly1		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_kqxwyxly1        ,/*NUMBER(5)*/
              cyj_kqxwyxly2		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_kqxwyxly2        ,/*NUMBER(5)*/
              cyj_rkkqwd		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_rkkqwd           ,/*NUMBER(5)*/
              cyj_kqxkqwd1		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_kqxkqwd1         ,/*NUMBER(5)*/
              cyj_kqxkqwd2		=  :data_3g->str_tcms_nr_v20.str_desel.cyj_kqxkqwd2         ,/*NUMBER(5)*/
              cyj_zyqjyjkyl1    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_zyqjyjkyl1       ,/*NUMBER(5)*/
              cyj_zyqjyjkyl2    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_zyqjyjkyl2       ,/*NUMBER(5)*/
              cyj_jkryyl    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_jkryyl           ,/*NUMBER(5)*/
              cyj_jyjkyl    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_jyjkyl           ,/*NUMBER(5)*/
              cyj_jyjkwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_jyjkwd           ,/*NUMBER(5)*/
              cyj_jyckwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_jyckwd           ,/*NUMBER(5)*/
              cyj_lqsckyl1    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_lqsckyl1         ,/*NUMBER(5)*/
              cyj_lqsckyl2    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_lqsckyl2         ,/*NUMBER(5)*/
              cyj_lqsjkyl1    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_lqsjkyl1         ,/*NUMBER(5)*/
              cyj_lqsjkyl2    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_lqsjkyl2         ,/*NUMBER(5)*/
              cyj_zlsbckyl    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_zlsbckyl         ,/*NUMBER(5)*/
              cyj_gwsbckyl    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_gwsbckyl         ,/*NUMBER(5)*/
              cyj_gwsjkwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_gwsjkwd          ,/*NUMBER(5)*/
              cyj_gwsckwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_gwsckwd          ,/*NUMBER(5) */
              cyj_zlsjkwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_zlsjkwd          ,/*NUMBER(5)*/
              cyj_zlsckwd    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_zlsckwd          ,/*NUMBER(5)*/
              cyj_cyjfzfkxh    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_cyjfzfkxh        ,/*NUMBER(5,1)*/
              cyj_dbkzqgddy    =  :data_3g->str_tcms_nr_v20.str_desel.cyj_dbkzqgddy        ,/*NUMBER(5,2)*/
              cyj_pyqddy	   =  :data_3g->str_tcms_nr_v20.str_desel.cyj_pyqddy           ,/*NUMBER(5,2)*/
              
			  qy_zf    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_zf                ,/*NUMBER(3)*/
              qy_gl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_gl                ,/*NUMBER(3)*/
              qy_skqsbdw    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_skqsbdw           ,/*NUMBER(3)*/
              qy_zflcdl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_zflcdl            ,/*NUMBER(5)*/
              qy_zfdjdl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_zfdjdl            ,/*NUMBER(5)*/
              qy_yjzjzlhldy    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_yjzjzlhldy        ,/*NUMBER(5)*/
              qy_ejzjzlhldy    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_ejzjzlhldy        ,/*NUMBER(5)*/
              qy_yjsdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_yjsdlj            ,/*NUMBER(5)*/
              qy_ejsdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_ejsdlj            ,/*NUMBER(5)*/
              qy_yjsjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_yjsjlj            ,/*NUMBER(5)*/
              qy_ejsjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_ejsjlj            ,/*NUMBER(5)*/
              qy_dj1_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj1_sdlj          ,/*NUMBER(5)*/
              qy_dj2_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj2_sdlj          ,/*NUMBER(5)*/
              qy_dj3_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj3_sdlj          ,/*NUMBER(5)*/
              qy_dj4_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj4_sdlj          ,/*NUMBER(5)*/
              qy_dj5_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj5_sdlj          ,/*NUMBER(5)*/
              qy_dj6_sdlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj6_sdlj          ,/*NUMBER(5)*/
              qy_dj1_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj1_sjlj          ,/*NUMBER(5)*/
              qy_dj2_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj2_sjlj          ,/*NUMBER(5)*/
              qy_dj3_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj3_sjlj          ,/*NUMBER(5)*/
              qy_dj4_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj4_sjlj          ,/*NUMBER(5)*/
              qy_dj5_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj5_sjlj          ,/*NUMBER(5)*/
              qy_dj6_sjlj    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj6_sjlj          , /*NUMBER(5)*/
              qy_yjdl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_yjdl              ,/*NUMBER(5)*/
              qy_ejdl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_ejdl              ,/*NUMBER(5)*/
              qy_dj1_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj1_dl            ,/*NUMBER(5)*/
              qy_dj2_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj2_dl            ,/*NUMBER(5)*/
              qy_dj3_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj3_dl            ,/*NUMBER(5)*/
              qy_dj4_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj4_dl            ,/*NUMBER(5)*/
              qy_dj5_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj5_dl            ,/*NUMBER(5)*/
              qy_dj6_dl    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj6_dl            ,/*NUMBER(5)*/
              qy_dj1_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj1_sjzs          ,/*NUMBER(5,1)*/
              qy_dj2_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj2_sjzs          ,/*NUMBER(5,1)*/
              qy_dj3_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj3_sjzs          ,/*NUMBER(5,1)*/
              qy_dj4_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj4_sjzs          ,/*NUMBER(5,1)*/
              qy_dj5_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj5_sjzs          ,/*NUMBER(5,1)*/
              qy_dj6_sjzs    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj6_sjzs          ,/*NUMBER(5,1)*/
              qy_dj1_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj1_wd            ,/*NUMBER(5)*/
              qy_dj2_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj2_wd            ,/*NUMBER(5)*/
              qy_dj3_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj3_wd            ,/*NUMBER(5)*/
              qy_dj4_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj4_wd            ,/*NUMBER(5)*/
              qy_dj5_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj5_wd            ,/*NUMBER(5)*/
              qy_dj6_wd    =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_dj6_wd            ,/*NUMBER(5)*/
              qy_jdldl     =  :data_3g->str_tcms_nr_v20.str_qianyin.qy_jdldl             ,/*NUMBER(5,2)*/
              
			  fz_st5		=  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_st5               ,/*NUMBER(3)*/
              fz_ffdjdy     =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_ffdjdy            ,/*NUMBER(5)*/
              fz_kyj1_bpqscpl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_kyj1_bpqscpl      ,/*NUMBER(5,1)*/
              fz_kyj1_bpqscyl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_kyj1_bpqscyl      ,/*NUMBER(5)*/
              fz_kyj2_bpqscpl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_kyj2_bpqscpl      ,/*NUMBER(5,1) */
              fz_kyj2_bpqscdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_kyj2_bpqscdy      ,/*NUMBER(5)*/
              fz_lqfs1_bpqscpl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs1_bpqscpl     ,/*NUMBER(5,1)*/
              fz_lqfs1_bpqscdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs1_bpqscdy     ,/*NUMBER(5)*/
              fz_lqfs2_bpqscpl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs2_bpqscpl     ,/*NUMBER(5,1)*/
              fz_lqfs2_bpqscdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs2_bpqscdy     ,/*NUMBER(5)*/
              fz_qytfjbpqscpl     =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_qytfjbpqscpl      ,/*NUMBER(5,1)*/
              fz_qytfjbpqscxdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_qytfjbpqscxdy     ,/*NUMBER(5)*/
              fz_lg1_scdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lg1_scdy          ,/*NUMBER(5)*/
              fz_lg1_scdl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lg1_scdl          ,/*NUMBER(5)*/
              fz_lg2_scdy    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lg2_scdy          ,/*NUMBER(5)*/
              fz_lg2_scdl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lg2_scdl          ,/*NUMBER(5)*/
              fz_lqfs1_pl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs1_pl          ,/*NUMBER(5)*/
              fz_lqfs2_pl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs2_pl          ,/*NUMBER(5)*/
              fz_lqfs3_pl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_lqfs3_pl          ,/*NUMBER(5)*/
              fz_yhzddztfjzs     =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_yhzddztfjzs       ,/*NUMBER(5)*/
              fz_eyhzddztfjzs    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_eyhzddztfjzs      ,/*NUMBER(5)*/
              fz_qytfj1_pl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_qytfj1_pl         ,/*NUMBER(5)*/
              fz_qytfj2_pl    =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_qytfj2_pl         ,/*NUMBER(5) */
              fz_zftfjgl      =  :data_3g->str_tcms_nr_v20.str_fuzhu.fz_zftfjgl           ,/*NUMBER(5)*/
              
			  bbxx_kyj1_yxsj  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_kyj1_yxsj       ,/*NUMBER(5)*/
              bbxx_kyj2_yxsj  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_kyj2_yxsj       ,/*NUMBER(5) */
              bbxx_jcyxlc     =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_jcyxlc          ,/*NUMBER(10)*/
              bbxx_qynlljl    =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_qynlljl         ,/*NUMBER(10)*/
              bbxx_zfhnlljl   =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_zfhnlljl        ,/*NUMBER(10)*/
              bbxx_dzzdnlljl  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_dzzdnlljl       ,/*NUMBER(10)*/
              bbxx_dzsjljl    =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_dzsjljl         ,/*NUMBER(10)*/
              bbxx_qysjljl    =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_qysjljl         ,/*NUMBER(10)*/
              bbxx_zfhsjljl   =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_zfhsjljl        ,/*NUMBER(10) */
              bbxx_dzzdsjljl  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_dzzdsjljl       ,/*NUMBER(10)*/
              bbxx_wjrjbbh    =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_wjrjbbh         ,/*NUMBER(10)*/
              bbxx_wjrjbbhry  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_wjrjbbhry       ,/*NUMBER(10)*/
              bbxx_wg_gwm_rjbbh		=  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_wg_gwm_rjbbh    ,/*NUMBER(10)*/
              bbxx_wg_gwm_rjbbh_ry  =  :data_3g->str_tcms_nr_v20.str_ljlybbxx.bbxx_wg_gwm_rjbbh_ry  /*NUMBER(10)*/;

    if (sqlca.sqlcode == 0)
    {
        //			memset(temp,0,1024);
        //			sprintf(temp,"loco.%s-%s:内燃机车V2.0 update success !!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
		//			lprintf(disp.e,temp);
        //			lprintf(disp.v,temp);
        //			cclog('e',temp);

        return 0;
    }
    else
    {
        memset(temp,0,1024);
        sprintf(temp,"loco.%s-%s:内燃机车V2.0 update failed!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        //printf("loco.%s-%s:内燃机车V2.0 update failed!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);

        return 1;
    }
}



unsigned char update_ITF_TCMS_HXN3_V10()//TCMS 内燃机车1.0
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_TCMS_HXN3_V10_LASTSTATUS SET 
               idx			= :data_3g->idx                 ,/*CHAR(32) not null*/
               t_type_id	= :data_3g->t_type_id            ,/*CHAR(3) not null*/
               loco_no		= :data_3g->loco_no              ,/*CHAR(4) not null*/
               ab			= :data_3g->ab                   ,/*NUMBER(1) default 0 not null*/
               btsj			= to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),
               rksj			= to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),
               tcms_xtsj	= to_date(:data_3g->tcms_xtsj ,'yyyy-mm-dd hh24:mi:ss'),
               tcms_ver		= :data_3g->tcms_ver               ,/*NUMBER(3)*/

               jb_ss		= :data_3g->str_tcms_v10.str_basic.jb_ss              ,/*NUMBER(1)*/
               jb_kzhx		= :data_3g->str_tcms_v10.str_basic.jb_kzhx            ,/*NUMBER(1)*/
               jb_zdh		= :data_3g->str_tcms_v10.str_basic.jb_zdh             ,/*NUMBER(1)*/
               jb_sdg		= :data_3g->str_tcms_v10.str_basic.jb_sdg             ,/*NUMBER(1)*/
               jb_czd		= :data_3g->str_tcms_v10.str_basic.jb_czd             ,/*NUMBER(1)*/
               jb_yxfx		= :data_3g->str_tcms_v10.str_basic.jb_yxfx            ,/*NUMBER(1)*/
               jb_gk		= :data_3g->str_tcms_v10.str_basic.jb_gk              ,/*NUMBER(1)*/
               jb_gfx		= :data_3g->str_tcms_v10.str_basic.jb_gfx             ,/*NUMBER(1)*/
               jb_sbjw		= :data_3g->str_tcms_v10.str_basic.jb_sbjw            ,/*NUMBER(6,1)*/
               jb_qyzdl_jh  = :data_3g->str_tcms_v10.str_basic.jb_qyzdl_jh        ,/*NUMBER(6,1)*/
               jb_qyzdl_sj  = :data_3g->str_tcms_v10.str_basic.jb_qyzdl_sj        ,/*NUMBER(6,1)*/
               jb_sdsdz		= :data_3g->str_tcms_v10.str_basic.jb_sdsdz           ,/*NUMBER(6,1)*/
               jb_sdsjz		= :data_3g->str_tcms_v10.str_basic.jb_sdsjz           ,/*NUMBER(6,1)*/
               jb_wyzfdy	= :data_3g->str_tcms_v10.str_basic.jb_wyzfdy          ,/*NUMBER(5)*/
               jb_wyzfdl	= :data_3g->str_tcms_v10.str_basic.jb_wyzfdl          ,/*NUMBER(5)*/
               jb_zfgyl		= :data_3g->str_tcms_v10.str_basic.jb_zfgyl           ,/*NUMBER(5)*/
               jb_lcgyl		= :data_3g->str_tcms_v10.str_basic.jb_lcgyl           ,/*NUMBER(5)*/
               jb_zdgyl		= :data_3g->str_tcms_v10.str_basic.jb_zdgyl           ,/*NUMBER(5)*/
               jb_jhfgyl	= :data_3g->str_tcms_v10.str_basic.jb_jhfgyl          ,/*NUMBER(5)*/
               jb_xdcyl		= :data_3g->str_tcms_v10.str_basic.jb_xdcyl           ,/*NUMBER(5,1)*/
               jb_cyjzs		= :data_3g->str_tcms_v10.str_basic.jb_cyjzs           ,/*NUMBER(5)*/
               jb_zlc		= :data_3g->str_tcms_v10.str_basic.jb_zlc             ,/*NUMBER(5)*/

               cyj_jcsd			= :data_3g->str_tcms_v10.str_desel.cyj_jcsd           ,/*NUMBER(5,1)*/
               cyj_hlqfjwd		= :data_3g->str_tcms_v10.str_desel.cyj_hlqfjwd        ,/*NUMBER(5)*/
               cyj_zcqzxyl		= :data_3g->str_tcms_v10.str_desel.cyj_zcqzxyl        ,/*NUMBER(5,2)*/
               cyj_ycqzxyl		= :data_3g->str_tcms_v10.str_desel.cyj_ycqzxyl        ,/*NUMBER(5,2)*/
               cyj_zcjfkkqyl	= :data_3g->str_tcms_v10.str_desel.cyj_zcjfkkqyl      ,/*NUMBER(5)*/
               cyj_ycjfkkqyl	= :data_3g->str_tcms_v10.str_desel.cyj_ycjfkkqyl      ,/*NUMBER(5)*/
               cyj_jfkkqwd		= :data_3g->str_tcms_v10.str_desel.cyj_jfkkqwd        ,/*NUMBER(5)*/
               cyj_zcjfkkqwd	= :data_3g->str_tcms_v10.str_desel.cyj_zcjfkkqwd      ,/*NUMBER(5)*/
               cyj_ycjfkkqwd	= :data_3g->str_tcms_v10.str_desel.cyj_ycjfkkqwd      ,/*NUMBER(5)*/
               cyj_kqjkwd		= :data_3g->str_tcms_v10.str_desel.cyj_kqjkwd         ,/*NUMBER(5)*/
               cyj_jywd			= :data_3g->str_tcms_v10.str_desel.cyj_jywd           ,/*NUMBER(5)*/
               cyj_jkryyl		= :data_3g->str_tcms_v10.str_desel.cyj_jkryyl         ,/*NUMBER(5)*/
               cyj_jyjkyl		= :data_3g->str_tcms_v10.str_desel.cyj_jyjkyl         ,/*NUMBER(5)*/
               cyj_zyq_zcjyjkyl = :data_3g->str_tcms_v10.str_desel.cyj_zyq_zcjyjkyl   ,/*NUMBER(5)*/
               cyj_zyq_ycjyjkyl = :data_3g->str_tcms_v10.str_desel.cyj_zyq_ycjyjkyl   ,/*NUMBER(5)*/
               cyj_jkjywd		= :data_3g->str_tcms_v10.str_desel.cyj_jkjywd         ,/*NUMBER(5)*/
               cyj_zclqsckyl	= :data_3g->str_tcms_v10.str_desel.cyj_zclqsckyl      ,/*NUMBER(5)*/
               cyj_yclqsckyl	= :data_3g->str_tcms_v10.str_desel.cyj_yclqsckyl      ,/*NUMBER(5)*/
               cyj_zclqsjkyl	= :data_3g->str_tcms_v10.str_desel.cyj_zclqsjkyl      ,/*NUMBER(5)*/
               cyj_yclqsjkyl	= :data_3g->str_tcms_v10.str_desel.cyj_yclqsjkyl      ,/*NUMBER(5)*/
               cyj_cksyl		= :data_3g->str_tcms_v10.str_desel.cyj_cksyl          ,/*NUMBER(5)*/
               cyj_dqyl			= :data_3g->str_tcms_v10.str_desel.cyj_dqyl           ,/*NUMBER(5,3)*/
               cyj_ryyl			= :data_3g->str_tcms_v10.str_desel.cyj_ryyl           ,/*NUMBER(5)*/
               cyj_ryyw			= :data_3g->str_tcms_v10.str_desel.cyj_ryyw           ,/*NUMBER(5)*/
               cyj_fzfkxh		= :data_3g->str_tcms_v10.str_desel.cyj_fzfkxh         ,/*NUMBER(5,3)*/
               cyj_zfglsc		= :data_3g->str_tcms_v10.str_desel.cyj_zfglsc         ,/*NUMBER(5)*/
               cyj_glsczs		= :data_3g->str_tcms_v10.str_desel.cyj_glsczs         ,/*NUMBER(9)*/
               cyj_qyl			= :data_3g->str_tcms_v10.str_desel.cyj_qyl            ,/*NUMBER(5)*/

               qy_sdsd  = :data_3g->str_tcms_v10.str_qianyin.qy_sdsd            ,/*NUMBER(6,1)*/
               qy_sjsd  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd            ,/*NUMBER(6,1)*/
               qy_fx	= :data_3g->str_tcms_v10.str_qianyin.qy_fx              ,/*NUMBER(3)*/
               qy_zgl	= :data_3g->str_tcms_v10.str_qianyin.qy_zgl             ,/*NUMBER(3)*/
               qy_qyzdlsdz_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg1mt ,/*NUMBER(5,1)*/
               qy_qyzdlsdz_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg2mt ,/*NUMBER(5,1)*/
               qy_qyzdlsdz_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg3mt ,/*NUMBER(5,1)*/
               qy_qyzdlsdz_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg1mt ,/*NUMBER(5,1)*/
               qy_qyzdlsdz_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg2mt ,/*NUMBER(5,1)*/
               qy_qyzdlsdz_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg3mt ,/*NUMBER(5,1)*/
               qy_sjsd_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg1mt     ,/*NUMBER(5,1)*/
               qy_sjsd_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg2mt     ,/*NUMBER(5,1)*/
               qy_sjsd_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg3mt     ,/*NUMBER(5,1)*/
               qy_sjsd_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg1mt     ,/*NUMBER(5,1)*/
               qy_sjsd_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg2mt     ,/*NUMBER(5,1)*/
               qy_sjsd_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg3mt     ,/*NUMBER(5,1)*/
               qy_fdjdy		   = :data_3g->str_tcms_v10.str_qianyin.qy_fdjdy           ,/*NUMBER(5)*/
               qy_fdjdl		   = :data_3g->str_tcms_v10.str_qianyin.qy_fdjdl           ,/*NUMBER(5)*/
               qy_qyblq1_zjdy  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_zjdy     ,/*NUMBER(5)*/
               qy_qyblq1_zjdl  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_zjdl     ,/*NUMBER(5)*/
               qy_qyblq2_zjdy  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_zjdy     ,/*NUMBER(5)*/
               qy_qyblq2_zjdl  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_zjdl     ,/*NUMBER(5)*/
               qy_qyblq1_lqsyl  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_lqsyl    ,/*NUMBER(5,2)*/
               qy_qyblq1_lqswd  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_lqswd    ,/*NUMBER(5)*/
               qy_qyblq2_lqsyl  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_lqsyl    ,/*NUMBER(5,2)*/
               qy_qyblq2_lqswd  = :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_lqswd    ,/*NUMBER(5)*/
               qy_qybyqyw1		= :data_3g->str_tcms_v10.str_qianyin.qy_qybyqyw1        ,/*NUMBER(5)*/
               qy_qybyqyw2		= :data_3g->str_tcms_v10.str_qianyin.qy_qybyqyw2        ,/*NUMBER(5)*/
               qy_qyzdlsjz_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg1mt ,/*NUMBER(5,1)*/
               qy_qyzdlsjz_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg2mt ,/*NUMBER(5,1)*/
               qy_qyzdlsjz_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg3mt ,/*NUMBER(5,1)*/
               qy_qyzdlsjz_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg1mt ,/*NUMBER(5,1)*/
               qy_qyzdlsjz_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg2mt ,/*NUMBER(5,1)*/
               qy_qyzdlsjz_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg3mt ,/*NUMBER(5,1)*/
               qy_djwd_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg1mt     ,/*NUMBER(5)*/
               qy_djwd_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg2mt     ,/*NUMBER(5)*/
               qy_djwd_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg3mt     ,/*NUMBER(5)*/
               qy_djwd_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg1mt     ,/*NUMBER(5)*/
               qy_djwd_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg2mt     ,/*NUMBER(5)*/
               qy_djwd_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg3mt     ,/*NUMBER(5)*/
               qy_djdl_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg1mt     ,/*NUMBER(5)*/
               qy_djdl_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg2mt     ,/*NUMBER(5)*/
               qy_djdl_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg3mt     ,/*NUMBER(5)*/
               qy_djdl_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg1mt     ,/*NUMBER(5)*/
               qy_djdl_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg2mt     ,/*NUMBER(5)*/
               qy_djdl_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg3mt     ,/*NUMBER(5)*/
               qy_djdy_1bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg1mt     ,/*NUMBER(5)*/
               qy_djdy_1bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg2mt     ,/*NUMBER(5)*/
               qy_djdy_1bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg3mt     ,/*NUMBER(5)*/
               qy_djdy_2bg1mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg1mt     ,/*NUMBER(5)*/
               qy_djdy_2bg2mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg2mt     ,/*NUMBER(5)*/
               qy_djdy_2bg3mt  = :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg3mt     ,/*NUMBER(5)*/
               qy_cdjcq		   = :data_3g->str_tcms_v10.str_qianyin.qy_cdjcq           ,/*NUMBER(3)*/
               qy_djjcq		   = :data_3g->str_tcms_v10.str_qianyin.qy_djjcq           ,/*NUMBER(3)*/
               qy_djgl		   = :data_3g->str_tcms_v10.str_qianyin.qy_djgl            ,/*NUMBER(3)*/
               qy_kz		   = :data_3g->str_tcms_v10.str_qianyin.qy_kz              ,/*NUMBER(3)*/

               fz_bppvsdz	   = :data_3g->str_tcms_v10.str_fuzhu.fz_bppvsdz         ,/*NUMBER(5)*/
               fz_dppvsdz	   = :data_3g->str_tcms_v10.str_fuzhu.fz_dppvsdz         ,/*NUMBER(5)*/
               fz_fb1zt		   = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1zt           ,/*NUMBER(3)*/
               fz_fb2zt		   = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2zt           ,/*NUMBER(3)*/
               fz_fb1_zlqsrdy  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zlqsrdy     ,/*NUMBER(5)*/
               fz_fb1_zlqsrdl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zlqsrdl     ,/*NUMBER(5)*/
               fz_fb1_zjzldy   = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zjzldy      ,/*NUMBER(5)*/
               fz_fb1_nbqscdy  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscdy     ,/*NUMBER(5)*/
               fz_fb1_nbqscdl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscdl     ,/*NUMBER(5)*/
               fz_fb1_nbqscpl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscpl     ,/*NUMBER(5)*/
               fz_fb2_zlqsrdy  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zlqsrdy     ,/*NUMBER(5)*/
               fz_fb2_zlqsrdl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zlqsrdl     ,/*NUMBER(5)*/
               fz_fb2_zjzldy   = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zjzldy      ,/*NUMBER(5)*/
               fz_fb2_nbqscdy  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscdy     ,/*NUMBER(5)*/
               fz_fb2_nbqscdl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscdl     ,/*NUMBER(5)*/
               fz_fb2_nbqscpl  = :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscpl     ,/*NUMBER(5)*/

               zd_sdsd		= :data_3g->str_tcms_v10.str_zhidong.zd_sdsd            ,/*NUMBER(5,1)*/
               zd_sjsd		= :data_3g->str_tcms_v10.str_zhidong.zd_sjsd            ,/*NUMBER(5,1)*/
               zd_fxzd		= :data_3g->str_tcms_v10.str_zhidong.zd_fxzd            ,/*NUMBER(3)*/
               zd_abh		= :data_3g->str_tcms_v10.str_zhidong.zd_abh             ,/*NUMBER(3)*/
               zd_ibh		= :data_3g->str_tcms_v10.str_zhidong.zd_ibh             ,/*NUMBER(3)*/
               zd_zdqq		= :data_3g->str_tcms_v10.str_zhidong.zd_zdqq            ,/*NUMBER(3)*/
               zd_bcu		= :data_3g->str_tcms_v10.str_zhidong.zd_bcu             ,/*NUMBER(3)*/
               zd_dzdsdz	= :data_3g->str_tcms_v10.str_zhidong.zd_dzdsdz          ,/*NUMBER(5)*/
               zd_zfgyl		= :data_3g->str_tcms_v10.str_zhidong.zd_zfgyl           ,/*NUMBER(5)*/
               zd_jhfgyl	= :data_3g->str_tcms_v10.str_zhidong.zd_jhfgyl          ,/*NUMBER(5)*/
               zd_lcgyl		= :data_3g->str_tcms_v10.str_zhidong.zd_lcgyl           ,/*NUMBER(5)*/
               zd_zdfg1yl	= :data_3g->str_tcms_v10.str_zhidong.zd_zdfg1yl         ,/*NUMBER(5)*/
               zd_zdfg2yl	= :data_3g->str_tcms_v10.str_zhidong.zd_zdfg2yl         ,/*NUMBER(5)*/
               zd_zdjzt		= :data_3g->str_tcms_v10.str_zhidong.zd_zdjzt            /*NUMBER(5)*/;

    if (sqlca.sqlcode == 0)
    {
        //			memset(temp,0,1024);
        //			sprintf(temp,"loco.%s-%s,内燃机车V1.0 update success !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
		//			lprintf(disp.e,temp);
        //			lprintf(disp.v,temp);
        //			cclog('e',temp);

        return 0;
    }
    else
    {
        memset(temp,0,1024);
        //printf("loco.%s-%s:内燃机车V1.0 update failed !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
		
        /*printf("1=%d,2=%d,3=%d,4=%d,5=%d,6=%d,7=%d,8=%d,9=%f,10=%f,11=%f,12=%f,13=%f,14=%d,15=%d,16=%d,17=%d,18=%d,19=%d,20=%f,21=%d,22=%d\n",
               data_3g->str_tcms_v10.str_basic.jb_ss              ,
               data_3g->str_tcms_v10.str_basic.jb_kzhx            ,
               data_3g->str_tcms_v10.str_basic.jb_zdh             ,
               data_3g->str_tcms_v10.str_basic.jb_sdg             ,
               data_3g->str_tcms_v10.str_basic.jb_czd             ,
               data_3g->str_tcms_v10.str_basic.jb_yxfx            ,
               data_3g->str_tcms_v10.str_basic.jb_gk              ,
               data_3g->str_tcms_v10.str_basic.jb_gfx             ,
               data_3g->str_tcms_v10.str_basic.jb_sbjw            ,
               data_3g->str_tcms_v10.str_basic.jb_qyzdl_jh        ,
               data_3g->str_tcms_v10.str_basic.jb_qyzdl_sj        ,
               data_3g->str_tcms_v10.str_basic.jb_sdsdz           ,
               data_3g->str_tcms_v10.str_basic.jb_sdsjz           ,
               data_3g->str_tcms_v10.str_basic.jb_wyzfdy          ,
               data_3g->str_tcms_v10.str_basic.jb_wyzfdl          ,
               data_3g->str_tcms_v10.str_basic.jb_zfgyl           ,
               data_3g->str_tcms_v10.str_basic.jb_lcgyl           ,
               data_3g->str_tcms_v10.str_basic.jb_zdgyl           ,
               data_3g->str_tcms_v10.str_basic.jb_jhfgyl          ,
               data_3g->str_tcms_v10.str_basic.jb_xdcyl           ,
               data_3g->str_tcms_v10.str_basic.jb_cyjzs           ,
               data_3g->str_tcms_v10.str_basic.jb_zlc);*/

        sprintf(temp,"loco.%s-%s:内燃机车V1.0 update failed !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
        lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }
}



unsigned char update_ITF_TCMS_V10()
{
    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL UPDATE AP_TCMS_V10_LASTSTATUS SET 

              idx		 =  :data_3g->idx                 ,/*CHAR(32) not null*/
              t_type_id  =  :data_3g->t_type_id            ,/*CHAR(3) not null */
              loco_no    =  :data_3g->loco_no              ,/*CHAR(4) not null*/
              ab		 =  :data_3g->ab                   ,/*NUMBER(1) default 0 not null*/
              btsj		 =  to_date(:data_3g->btsj ,'yyyy-mm-dd hh24:mi:ss'),
              rksj		 =  to_date(:data_3g->rksj ,'yyyy-mm-dd hh24:mi:ss'),
              tcms_xtsj  =  to_date(:data_3g->tcms_xtsj ,'yyyy-mm-dd hh24:mi:ss'),
              tcms_ver   =  :data_3g->tcms_ver               ,/*NUMBER(3)*/

              jb_ss			=  :data_3g->str_tcms_v10.str_basic.jb_ss              ,/*NUMBER(1)*/
              jb_kzhx		=  :data_3g->str_tcms_v10.str_basic.jb_kzhx            ,/*NUMBER(1)*/
              jb_zdh		=  :data_3g->str_tcms_v10.str_basic.jb_zdh             ,/*NUMBER(1)*/
              jb_sdg		=  :data_3g->str_tcms_v10.str_basic.jb_sdg             ,/*NUMBER(1)*/
              jb_czd		=  :data_3g->str_tcms_v10.str_basic.jb_czd             ,/*NUMBER(1)*/
              jb_yxfx		=  :data_3g->str_tcms_v10.str_basic.jb_yxfx            ,/*NUMBER(1)*/
              jb_gk			=  :data_3g->str_tcms_v10.str_basic.jb_gk              ,/*NUMBER(1)*/
              jb_gfx		=  :data_3g->str_tcms_v10.str_basic.jb_gfx             ,/*NUMBER(1)*/
              jb_sbjw		=  :data_3g->str_tcms_v10.str_basic.jb_sbjw            ,/*NUMBER(6,1)*/
              jb_qyzdl_jh   =  :data_3g->str_tcms_v10.str_basic.jb_qyzdl_jh        ,/*NUMBER(6,1)*/
              jb_qyzdl_sj   =  :data_3g->str_tcms_v10.str_basic.jb_qyzdl_sj        ,/*NUMBER(6,1)*/
              jb_sdsdz		=  :data_3g->str_tcms_v10.str_basic.jb_sdsdz           ,/*NUMBER(6,1)*/
              jb_sdsjz		=  :data_3g->str_tcms_v10.str_basic.jb_sdsjz           ,/*NUMBER(6,1)*/
              jb_wyzfdy		=  :data_3g->str_tcms_v10.str_basic.jb_wyzfdy          ,/*NUMBER(5)*/
              jb_wyzfdl		=  :data_3g->str_tcms_v10.str_basic.jb_wyzfdl          ,/*NUMBER(5)*/
              jb_zfgyl		=  :data_3g->str_tcms_v10.str_basic.jb_zfgyl           ,/*NUMBER(5)*/
              jb_lcgyl		=  :data_3g->str_tcms_v10.str_basic.jb_lcgyl           ,/*NUMBER(5)*/
              jb_zdgyl		=  :data_3g->str_tcms_v10.str_basic.jb_zdgyl           ,/*NUMBER(5)*/
              jb_jhfgyl		=  :data_3g->str_tcms_v10.str_basic.jb_jhfgyl          ,/*NUMBER(5)*/
              jb_xdcyl		=  :data_3g->str_tcms_v10.str_basic.jb_xdcyl           ,/*NUMBER(5,1)*/
              jb_cyjzs		=  :data_3g->str_tcms_v10.str_basic.jb_cyjzs           ,/*NUMBER(5)*/
              jb_zlc		=  :data_3g->str_tcms_v10.str_basic.jb_zlc             ,/*NUMBER(5)*/

              qy_sdsd    =  :data_3g->str_tcms_v10.str_qianyin.qy_sdsd            ,/*NUMBER(6,1)*/
              qy_sjsd    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd            ,/*NUMBER(6,1)*/
              qy_fx      =  :data_3g->str_tcms_v10.str_qianyin.qy_fx              ,/*NUMBER(3)*/
              qy_zgl     =  :data_3g->str_tcms_v10.str_qianyin.qy_zgl             ,/*NUMBER(3)*/
              qy_qyzdlsdz_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg2mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_1bg3mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg2mt ,/*NUMBER(5,1)*/
              qy_qyzdlsdz_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsdz_2bg3mt ,/*NUMBER(5,1)*/
              qy_sjsd_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg1mt     ,/*NUMBER(5,1)*/
              qy_sjsd_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg2mt     ,/*NUMBER(5,1)*/
              qy_sjsd_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_1bg3mt     ,/*NUMBER(5,1)*/
              qy_sjsd_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg1mt     ,/*NUMBER(5,1)*/
              qy_sjsd_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg2mt     ,/*NUMBER(5,1)*/
              qy_sjsd_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_sjsd_2bg3mt     ,/*NUMBER(5,1)*/
              qy_fdjdy			=  :data_3g->str_tcms_v10.str_qianyin.qy_fdjdy           ,/*NUMBER(5)*/
              qy_fdjdl			=  :data_3g->str_tcms_v10.str_qianyin.qy_fdjdl           ,/*NUMBER(5)*/
              qy_qyblq1_zjdy    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_zjdy     ,/*NUMBER(5)*/
              qy_qyblq1_zjdl    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_zjdl     ,/*NUMBER(5)*/
              qy_qyblq2_zjdy    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_zjdy     ,/*NUMBER(5)*/
              qy_qyblq2_zjdl    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_zjdl     ,/*NUMBER(5)*/
              qy_qyblq1_lqsyl   =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_lqsyl    ,/*NUMBER(5,2)*/
              qy_qyblq1_lqswd   =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq1_lqswd    ,/*NUMBER(5)*/
              qy_qyblq2_lqsyl   =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_lqsyl    ,/*NUMBER(5,2)*/
              qy_qyblq2_lqswd   =  :data_3g->str_tcms_v10.str_qianyin.qy_qyblq2_lqswd    ,/*NUMBER(5)*/
              qy_qybyqyw1		=  :data_3g->str_tcms_v10.str_qianyin.qy_qybyqyw1        ,/*NUMBER(5)*/
              qy_qybyqyw2		=  :data_3g->str_tcms_v10.str_qianyin.qy_qybyqyw2        ,/*NUMBER(5)*/
              qy_qyzdlsjz_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg2mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_1bg3mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg1mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg2mt ,/*NUMBER(5,1)*/
              qy_qyzdlsjz_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_qyzdlsjz_2bg3mt ,/*NUMBER(5,1)*/
              qy_djwd_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg1mt     ,/*NUMBER(5)*/
              qy_djwd_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg2mt     ,/*NUMBER(5)*/
              qy_djwd_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_1bg3mt     ,/*NUMBER(5)*/
              qy_djwd_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg1mt     ,/*NUMBER(5)*/
              qy_djwd_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg2mt     ,/*NUMBER(5)*/
              qy_djwd_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djwd_2bg3mt     ,/*NUMBER(5)*/
              qy_djdl_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg1mt     ,/*NUMBER(5)*/
              qy_djdl_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg2mt     ,/*NUMBER(5)*/
              qy_djdl_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_1bg3mt     ,/*NUMBER(5)*/
              qy_djdl_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg1mt     ,/*NUMBER(5)*/
              qy_djdl_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg2mt     ,/*NUMBER(5)*/
              qy_djdl_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdl_2bg3mt     ,/*NUMBER(5)*/
              qy_djdy_1bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg1mt     ,/*NUMBER(5)*/
              qy_djdy_1bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg2mt     ,/*NUMBER(5)*/
              qy_djdy_1bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_1bg3mt     ,/*NUMBER(5)*/
              qy_djdy_2bg1mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg1mt     ,/*NUMBER(5)*/
              qy_djdy_2bg2mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg2mt     ,/*NUMBER(5)*/
              qy_djdy_2bg3mt    =  :data_3g->str_tcms_v10.str_qianyin.qy_djdy_2bg3mt     ,/*NUMBER(5)*/
              qy_cdjcq			=  :data_3g->str_tcms_v10.str_qianyin.qy_cdjcq           ,/*NUMBER(3)*/
              qy_djjcq			=  :data_3g->str_tcms_v10.str_qianyin.qy_djjcq           ,/*NUMBER(3)*/
              qy_djgl			=  :data_3g->str_tcms_v10.str_qianyin.qy_djgl            ,/*NUMBER(3)*/
              qy_kz				=  :data_3g->str_tcms_v10.str_qianyin.qy_kz              ,/*NUMBER(3)*/

              fz_bppvsdz		=  :data_3g->str_tcms_v10.str_fuzhu.fz_bppvsdz         ,/*NUMBER(5)*/
              fz_dppvsdz		=  :data_3g->str_tcms_v10.str_fuzhu.fz_dppvsdz         ,/*NUMBER(5)*/
              fz_fb1zt			=  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1zt           ,/*NUMBER(3)*/
              fz_fb2zt			=  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2zt           ,/*NUMBER(3)*/
              fz_fb1_zlqsrdy    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zlqsrdy     ,/*NUMBER(5)*/
              fz_fb1_zlqsrdl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zlqsrdl     ,/*NUMBER(5)*/
              fz_fb1_zjzldy     =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_zjzldy      ,/*NUMBER(5)*/
              fz_fb1_nbqscdy    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscdy     ,/*NUMBER(5)*/
              fz_fb1_nbqscdl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscdl     ,/*NUMBER(5)*/
              fz_fb1_nbqscpl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb1_nbqscpl     ,/*NUMBER(5)*/
              fz_fb2_zlqsrdy    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zlqsrdy     ,/*NUMBER(5)*/
              fz_fb2_zlqsrdl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zlqsrdl     ,/*NUMBER(5)*/
              fz_fb2_zjzldy     =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_zjzldy      ,/*NUMBER(5)*/
              fz_fb2_nbqscdy    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscdy     ,/*NUMBER(5)*/
              fz_fb2_nbqscdl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscdl     ,/*NUMBER(5)*/
              fz_fb2_nbqscpl    =  :data_3g->str_tcms_v10.str_fuzhu.fz_fb2_nbqscpl     ,/*NUMBER(5)*/

              zd_sdsd		=  :data_3g->str_tcms_v10.str_zhidong.zd_sdsd            ,/*NUMBER(5,1)*/
              zd_sjsd		=  :data_3g->str_tcms_v10.str_zhidong.zd_sjsd            ,/*NUMBER(5,1)*/
              zd_fxzd		=  :data_3g->str_tcms_v10.str_zhidong.zd_fxzd            ,/*NUMBER(3)*/
              zd_abh		=  :data_3g->str_tcms_v10.str_zhidong.zd_abh             ,/*NUMBER(3)*/
              zd_ibh		=  :data_3g->str_tcms_v10.str_zhidong.zd_ibh             ,/*NUMBER(3)*/
              zd_zdqq		=  :data_3g->str_tcms_v10.str_zhidong.zd_zdqq            ,/*NUMBER(3)*/
              zd_bcu		=  :data_3g->str_tcms_v10.str_zhidong.zd_bcu             ,/*NUMBER(3)*/
              zd_dzdsdz		=  :data_3g->str_tcms_v10.str_zhidong.zd_dzdsdz          ,/*NUMBER(5)*/
              zd_zfgyl		=  :data_3g->str_tcms_v10.str_zhidong.zd_zfgyl           ,/*NUMBER(5)*/
              zd_jhfgyl		=  :data_3g->str_tcms_v10.str_zhidong.zd_jhfgyl          ,/*NUMBER(5)*/
              zd_lcgyl		=  :data_3g->str_tcms_v10.str_zhidong.zd_lcgyl           ,/*NUMBER(5)*/
              zd_zdfg1yl    =  :data_3g->str_tcms_v10.str_zhidong.zd_zdfg1yl         ,/*NUMBER(5)*/
              zd_zdfg2yl    =  :data_3g->str_tcms_v10.str_zhidong.zd_zdfg2yl         ,/*NUMBER(5)*/
              zd_zdjzt		=  :data_3g->str_tcms_v10.str_zhidong.zd_zdjzt            /*NUMBER(5)*/;

    if (sqlca.sqlcode == 0)
    {
        //			memset(temp,0,1024);
        //			sprintf(temp,"loco.%s-%s:电力机车V1.0 update success !!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
		//			lprintf(disp.e,temp);
        //			lprintf(disp.v,temp);
        //			cclog('e',temp);

        return 0;
    }	    
	else
	{
        memset(temp,0,1024);
        sprintf(temp,"loco.%s-%s:电力机车V1.0 update failed !!!,ORACLE返回值：%d\n",data_3g->t_type_id,data_3g->loco_no ,sqlca.sqlcode);
		lprintf(disp.e,temp);
        lprintf(disp.g,temp);
        cclog('e',temp);

        return 1;
    }
}

unsigned char insert_to_ITF_LDPFAULT_START(int index)
{
    char temp[1024];

    //printf("1\n");
    //printf("111 ITF_LDPFAULT_START data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;
    EXEC SQL
            INSERT INTO ITF_LDPFAULT_START(

                IDX         ,/*CHAR(32) not null,                */

                GZDM        ,/*NUMBER(10),                       */

                GZMC        ,/*VARCHAR2(100),                    */

                GZKSSJ      ,/*DATE,                             */

                GZDJ        ,/*NUMBER(2),                        */

                VER         ,/*NUMBER(3) default 10 not null,    */

                T_TYPE_ID   ,/*CHAR(3),                          */

                LOCO_NO     ,/*CHAR(4),                          */

                AB          ,/*NUMBER(1) default 0,              */

                D_ID        ,/*CHAR(4),                          */

                BTSJ        ,/*DATE,                             */

                RKSJ        ,/*DATE default SYSDATE,             */

                CZH         ,/*NUMBER(5),                        */

                SJJLH       ,/*NUMBER(5),                        */

                SJSD        ,/*NUMBER(7,2),                      */

                JCGKZ       ,/*NUMBER(5),                        */

                XHJBH       ,/*NUMBER(5),                        */

                XHJZLZ      ,/*NUMBER(5),                        */

                CC          ,/*VARCHAR2(20),                     */

                ZSJH        ,/*NUMBER(10),                       */

                FSJH        ,/*NUMBER(10),                       */

                GLB         ,/*NUMBER(10),                       */

                JKZT        ,/*NUMBER(5),                        */

                DRIVERNAME  ,/*VARCHAR2(30),                     */

                DRIVERTEL   ,/*VARCHAR2(32),                     */

                LINENO      ,/*NUMBER(5),                        */

                LINENAME    ,/*VARCHAR2(32),                     */

                STATIONNAME ,/*VARCHAR2(32),                     */

                GPSJD       ,/*NUMBER(12,6),                     */

                GPSWD       ,/*NUMBER(12,6),                     */

                GPSHB       ,/*NUMBER(8,2),                      */

                GPSSD       ,/*NUMBER(8,2),                      */

                D_ID2       ,/*CHAR(4),                          */

                B_ID        ,/*CHAR(2),                          */

                B_ID2       , /*CHAR(2),                          */

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                trim(:data_fault->DRIVERNAME)  ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL )  ,/*VARCHAR2(32),                    */

                trim(:data_fault->LINENO)      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->B_ID2)       , /*CHAR(2),                         */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:TCMSFAULT_START：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:LDPFAULT_START：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_LDPFAULT_STOP(int index)

{

    char temp[1024];

    //printf("2\n");

    //printf("111 ITF_LDPFAULT_STOP data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_LDPFAULT_STOP(

                IDX       ,/*CHAR(32) not null,              */

                GZDM      ,/*NUMBER(10),                     */

                GZJSSJ    ,/*DATE,                           */

                VER       ,/*NUMBER(3) default 10 not null,  */

                T_TYPE_ID ,/*CHAR(3),                        */

                LOCO_NO   ,/*CHAR(4),                        */

                AB        ,/*NUMBER(1) default 0,            */

                BTSJ      ,/*DATE,                           */

                RKSJ      ,/*DATE default SYSDATE,           */

                CZH       ,/*NUMBER(5),                      */

                SJJLH     ,/*NUMBER(5),                      */

                SJSD      ,/*NUMBER(7,2),                    */

                JCGKZ     ,/*NUMBER(5),                      */

                XHJBH     ,/*NUMBER(5),                      */

                XHJZLZ    ,/*NUMBER(5),                      */

                CC        ,/*VARCHAR2(20),                   */

                ZSJH      ,/*NUMBER(10),                     */

                FSJH      ,/*NUMBER(10),                     */

                GLB       ,/*NUMBER(10),                     */

                JKZT      ,/*NUMBER(3),                      */

                GPSJD     ,/*NUMBER(12,6),                   */

                GPSWD     ,/*NUMBER(12,6),                   */

                GPSHB     ,/*NUMBER(8,2),                    */

                GPSSD     ,/*NUMBER(8,2),                    */

                D_ID2     ,/*CHAR(4),                        */

                B_ID      ,/*CHAR(2),                        */

                D_ID      ,/*CHAR(4)                         */

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );



    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:TCMSFAULT_STOP：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:LDPFAULT_STOP：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_TCMSFAULT_START(int index)

{

    char temp[1024];

    //printf("3\n");

    //printf("111 ITF_TCMSFAULT_START data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_TCMSFAULT_START(

                IDX         ,/*CHAR(32) not null,                */

                GZDM        ,/*NUMBER(10),                       */

                GZMC        ,/*VARCHAR2(100),                    */

                GZKSSJ      ,/*DATE,                             */

                GZDJ        ,/*NUMBER(2),                        */

                GZDM_WM     ,/*NUMBER(5),                        */

                VER         ,/*NUMBER(3) default 10 not null,    */

                T_TYPE_ID   ,/*CHAR(3),                          */

                LOCO_NO     ,/*CHAR(4),                          */

                AB          ,/*NUMBER(1) default 0,              */

                D_ID        ,/*CHAR(4),                          */

                BTSJ        ,/*DATE,                             */

                RKSJ        ,/*DATE default SYSDATE,             */

                CZH         ,/*NUMBER(5),                        */

                SJJLH       ,/*NUMBER(5),                        */

                SJSD        ,/*NUMBER(7,2),                      */

                JCGKZ       ,/*NUMBER(5),                        */

                XHJBH       ,/*NUMBER(5),                        */

                XHJZLZ      ,/*NUMBER(5),                        */

                CC          ,/*VARCHAR2(20),                     */

                ZSJH        ,/*NUMBER(10),                       */

                FSJH        ,/*NUMBER(10),                       */

                GLB         ,/*NUMBER(10),                       */

                JKZT        ,/*NUMBER(5),                        */

                DRIVERNAME  ,/*VARCHAR2(30),                     */

                DRIVERTEL   ,/*VARCHAR2(32),                     */

                LINENO      ,/*NUMBER(5),                        */

                LINENAME    ,/*VARCHAR2(32),                     */

                STATIONNAME ,/*VARCHAR2(32),                     */

                GPSJD       ,/*NUMBER(12,6),                     */

                GPSWD       ,/*NUMBER(12,6),                     */

                GPSHB       ,/*NUMBER(8,2),                      */

                GPSSD       ,/*NUMBER(8,2),                      */

                D_ID2       ,/*CHAR(4),                          */

                B_ID        ,/*CHAR(2),                          */

                B_ID2       , /*CHAR(2),                          */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                trim(:data_fault->DRIVERNAME)  ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL )  ,/*VARCHAR2(32),                    */

                trim(:data_fault->LINENO)      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->B_ID2)        ,/*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW)  ,  /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:TCMSFAULT_START：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:TCMSFAULT_START：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_TCMSFAULT_D_START(int index)

{

    char temp[1024];

    //printf("4\n");

    //printf("111 ITF_TCMSFAULT_D_START data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_TCMSFAULT_D_START(

                IDX         ,/*CHAR(32) not null,                */

                GZDM        ,/*NUMBER(10),                       */

                GZMC        ,/*VARCHAR2(100),                    */

                GZKSSJ      ,/*DATE,                             */

                GZDJ        ,/*NUMBER(2),                        */

                GZDM_WM     ,/*NUMBER(5),                        */

                VER         ,/*NUMBER(3) default 10 not null,    */

                T_TYPE_ID   ,/*CHAR(3),                          */

                LOCO_NO     ,/*CHAR(4),                          */

                AB          ,/*NUMBER(1) default 0,              */

                D_ID        ,/*CHAR(4),                          */

                BTSJ        ,/*DATE,                             */

                RKSJ        ,/*DATE default SYSDATE,             */

                CZH         ,/*NUMBER(5),                        */

                SJJLH       ,/*NUMBER(5),                        */

                SJSD        ,/*NUMBER(7,2),                      */

                JCGKZ       ,/*NUMBER(5),                        */

                XHJBH       ,/*NUMBER(5),                        */

                XHJZLZ      ,/*NUMBER(5),                        */

                CC          ,/*VARCHAR2(20),                     */

                ZSJH        ,/*NUMBER(10),                       */

                FSJH        ,/*NUMBER(10),                       */

                GLB         ,/*NUMBER(10),                       */

                JKZT        ,/*NUMBER(5),                        */

                DRIVERNAME  ,/*VARCHAR2(30),                     */

                DRIVERTEL   ,/*VARCHAR2(32),                     */

                LINENO      ,/*NUMBER(5),                        */

                LINENAME    ,/*VARCHAR2(32),                     */

                STATIONNAME ,/*VARCHAR2(32),                     */

                GPSJD       ,/*NUMBER(12,6),                     */

                GPSWD       ,/*NUMBER(12,6),                     */

                GPSHB       ,/*NUMBER(8,2),                      */

                GPSSD       ,/*NUMBER(8,2),                      */

                D_ID2       ,/*CHAR(4),                          */

                B_ID        ,/*CHAR(2),                          */

                B_ID2       , /*CHAR(2),                          */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                trim(:data_fault->DRIVERNAME)  ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL)   ,/*VARCHAR2(32),                    */

                :data_fault->LINENO      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->B_ID2)       ,/*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW),     /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );



    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:TCMSFAULT_D_START：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:TCMSFAULT_D_START：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_TCMSFAULT_STOP(int index)

{

    char temp[1024];

    //printf("5\n");

    //printf("111 ITF_TCMSFAULT_STOP data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_TCMSFAULT_STOP(

                IDX       ,/*CHAR(32) not null,              */

                GZDM      ,/*NUMBER(10),                     */

                GZJSSJ    ,/*DATE,                           */

                GZDM_WM   ,/*NUMBER(5),                      */

                VER       ,/*NUMBER(3) default 10 not null,  */

                T_TYPE_ID ,/*CHAR(3),                        */

                LOCO_NO   ,/*CHAR(4),                        */

                AB        ,/*NUMBER(1) default 0,            */

                BTSJ      ,/*DATE,                           */

                RKSJ      ,/*DATE default SYSDATE,           */

                CZH       ,/*NUMBER(5),                      */

                SJJLH     ,/*NUMBER(5),                      */

                SJSD      ,/*NUMBER(7,2),                    */

                JCGKZ     ,/*NUMBER(5),                      */

                XHJBH     ,/*NUMBER(5),                      */

                XHJZLZ    ,/*NUMBER(5),                      */

                CC        ,/*VARCHAR2(20),                   */

                ZSJH      ,/*NUMBER(10),                     */

                FSJH      ,/*NUMBER(10),                     */

                GLB       ,/*NUMBER(10),                     */

                JKZT      ,/*NUMBER(3),                      */

                GPSJD     ,/*NUMBER(12,6),                   */

                GPSWD     ,/*NUMBER(12,6),                   */

                GPSHB     ,/*NUMBER(8,2),                    */

                GPSSD     ,/*NUMBER(8,2),                    */

                D_ID2     ,/*CHAR(4),                        */

                B_ID      ,/*CHAR(2),                        */

                D_ID      ,/*CHAR(4)                         */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                trim(:data_fault->str_fault[index].CODESHOW),     /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );



    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:TCMSFAULT_STOP：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:TCMSFAULT_STOP：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_6AFAULT_START(int index)

{

    char temp[1024];

    //printf("111 ITF_6AFAULT_START data_fault->CRK = %d\n",data_fault->CRK);

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_6AFAULT_START(

                IDX         ,/*CHAR(32) not null,              */

                GZDM        ,/*NUMBER(10),                     */

                GZMC        ,/*VARCHAR2(100),                  */

                GZKSSJ      ,/*DATE,                           */

                BTSJ        ,/*DATE,                           */

                RKSJ        ,/*DATE default SYSDATE,           */

                GZDJ        ,/*NUMBER(2),                      */

                GZDM_WM     ,/*NUMBER(5),                      */

                VER         ,/*NUMBER(3) default 10 not null,  */

                D_ID        ,/*CHAR(4),                        */

                T_TYPE_ID   ,/*CHAR(3),                        */

                LOCO_NO     ,/*CHAR(4),                        */

                AB          ,/*NUMBER(1) default 0,            */

                CZH         ,/*NUMBER(5),                      */

                SJJLH       ,/*NUMBER(5),                      */

                SJSD        ,/*NUMBER(7,2),                    */

                JCGKZ       ,/*NUMBER(5),                      */

                XHJBH       ,/*NUMBER(5),                      */

                XHJZLZ      ,/*NUMBER(5),                      */

                CC          ,/*VARCHAR2(20),                   */

                ZSJH        ,/*NUMBER(10),                     */

                FSJH        ,/*NUMBER(10),                     */

                GLB         ,/*NUMBER(10),                     */

                JKZT        ,/*NUMBER(3),                      */

                DRIVERNAME  ,/*VARCHAR2(30),                   */

                DRIVERTEL   ,/*VARCHAR2(32),                   */

                LINENO      ,/*NUMBER(5),                      */

                LINENAME    ,/*VARCHAR2(32),                   */

                STATIONNAME ,/*VARCHAR2(32),                   */

                GPSJD       ,/*NUMBER(12,6),                   */

                GPSWD       ,/*NUMBER(12,6),                   */

                GPSHB       ,/*NUMBER(8,2),                    */

                GPSSD       ,/*NUMBER(8,2),                    */

                D_ID2       ,/*CHAR(4),                        */

                B_ID        ,/*CHAR(2),                        */

                B_ID2       ,/*CHAR(2),                        */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                trim(:data_fault->DRIVERNAME)  ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL)   ,/*VARCHAR2(32),                    */

                :data_fault->LINENO      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->B_ID2)       , /*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW)  ,   /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );

    //printf("ITF_6AFAULT_START data_fault->CRK = %d\n",data_fault->CRK);

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:6AFAULT_START：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:6AFAULT_START：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_6AFAULT_STOP(int index)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_6AFAULT_STOP(

                IDX       ,/*CHAR(32) not null,               */

                GZDM      ,/*NUMBER(10),                      */

                GZJSSJ    ,/*DATE,                            */

                BTSJ      ,/*DATE,                            */

                RKSJ      ,/*DATE default SYSDATE,            */

                GZDM_WM   ,/*NUMBER(5),                       */

                VER       ,/*NUMBER(3) default 10 not null,   */

                T_TYPE_ID ,/*CHAR(3),                         */

                LOCO_NO   ,/*CHAR(4),                         */

                AB        ,/*NUMBER(1) default 0 not null,    */

                CZH       ,/*NUMBER(5),                       */

                SJJLH     ,/*NUMBER(5),                       */

                SJSD      ,/*NUMBER(7,2),                     */

                JCGKZ     ,/*NUMBER(5),                       */

                XHJBH     ,/*NUMBER(5),                       */

                XHJZLZ    ,/*NUMBER(5),                       */

                CC        ,/*VARCHAR2(20),                    */

                ZSJH      ,/*NUMBER(10),                      */

                FSJH      ,/*NUMBER(10),                      */

                GLB       ,/*NUMBER(10),                      */

                JKZT      ,/*NUMBER(3),                       */

                GPSJD     ,/*NUMBER(12,6),                    */

                GPSWD     ,/*NUMBER(12,6),                    */

                GPSHB     ,/*NUMBER(8,2),                     */

                GPSSD     ,/*NUMBER(8,2),                     */

                D_ID2     ,/*CHAR(4),                         */

                B_ID      ,/*CHAR(2),                         */

                D_ID      ,/*CHAR(4)                          */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                trim(:data_fault->str_fault[index].CODESHOW)    , /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:6AFAULT_STOP：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:6AFAULT_STOP：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_FAULT_UNTREATED(int index)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_FAULT_UNTREATED(

                IDX         ,/*CHAR(32) not null,               */

                VER         ,/*NUMBER(3) default 10 not null,   */

                D_ID        ,/*CHAR(4),                         */

                T_TYPE_ID   ,/*CHAR(3),                         */

                LOCO_NO     ,/*CHAR(4),                         */

                AB          ,/*NUMBER(1),                       */

                BTSJ        ,/*DATE,                            */

                RKSJ        ,/*DATE default SYSDATE,            */

                GZKSSJ      ,/*DATE,                            */

                CZH         ,/*NUMBER(5),                       */

                SJJLH       ,/*NUMBER(5),                       */

                SJSD        ,/*NUMBER(7,2),                     */

                JCGKZ       ,/*NUMBER(5),                       */

                XHJBH       ,/*NUMBER(5),                       */

                XHJZLZ      ,/*NUMBER(5),                       */

                CC          ,/*VARCHAR2(20),                    */

                ZSJH        ,/*NUMBER(10),                      */

                FSJH        ,/*NUMBER(10),                      */

                GLB         ,/*NUMBER(10),                      */

                GZDM        ,/*NUMBER(10),                      */

                GZLY        ,/*NUMBER(2),                       */

                GZMC        ,/*VARCHAR2(100),                   */

                GZDJ        ,/*NUMBER(2) default 0,             */

                GZDM_WM     ,/*NUMBER(5),                       */

                DRIVERNAME  ,/*VARCHAR2(30),                    */

                DRIVERTEL   ,/*VARCHAR2(32),                    */

                LINENO      ,/*NUMBER(5),                       */

                LINENAME    ,/*VARCHAR2(32),                    */

                STATIONNAME ,/*VARCHAR2(32),                    */

                JKZT        ,/*NUMBER(3),                       */

                GPSJD       ,/*NUMBER(12,6),                    */

                GPSWD       ,/*NUMBER(12,6),                    */

                GPSHB       ,/*NUMBER(8,2),                     */

                GPSSD       ,/*NUMBER(8,2),                     */

                D_ID2       ,/*CHAR(4),                         */

                B_ID        ,/*CHAR(2)                          */

                B_ID2       , /*CHAR(2)                          */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                trim(:data_fault->D_ID )       ,/*CHAR(4),                         */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                :data_fault->str_fault[index].GZSB,

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                trim(:data_fault->DRIVERNAME ) ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL)   ,/*VARCHAR2(32),                    */

                :data_fault->LINENO      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2 )      ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->B_ID2)       ,/*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW)  ,   /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );



    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:FAULT_UNTREATED：故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:FAULT_UNTREATED：故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



unsigned char insert_to_ITF_FAULT_INVALID(int index)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_FAULT_INVALID(

                IDX         ,/*CHAR(32) not null,                */

                GZDM        ,/*NUMBER(10),                       */

                GZLY        ,/*NUMBER(2),                       */

                GZMC        ,/*VARCHAR2(100),                    */

                GZKSSJ      ,/*DATE,                             */

                GZDJ        ,/*NUMBER(2),                        */

                GZDM_WM     ,/*NUMBER(5),                        */

                VER         ,/*NUMBER(3) default 10 not null,    */

                D_ID        ,/*CHAR(4),                          */

                T_TYPE_ID   ,/*CHAR(3),                          */

                LOCO_NO     ,/*CHAR(4),                          */

                AB          ,/*NUMBER(1) default 0,              */

                BTSJ        ,/*DATE,                             */

                RKSJ        ,/*DATE default SYSDATE,             */

                CZH         ,/*NUMBER(5),                        */

                SJJLH       ,/*NUMBER(5),                        */

                SJSD        ,/*NUMBER(7,2),                      */

                JCGKZ       ,/*NUMBER(5),                        */

                XHJBH       ,/*NUMBER(5),                        */

                XHJZLZ      ,/*NUMBER(5),                        */

                CC          ,/*VARCHAR2(20),                     */

                ZSJH        ,/*NUMBER(10),                       */

                FSJH        ,/*NUMBER(10),                       */

                GLB         ,/*NUMBER(10),                       */

                JKZT        ,/*NUMBER(3),                        */

                DRIVERNAME  ,/*VARCHAR2(30),                     */

                DRIVERTEL   ,/*VARCHAR2(32),                     */

                LINENO      ,/*NUMBER(5),                        */

                LINENAME    ,/*VARCHAR2(32),                     */

                STATIONNAME ,/*VARCHAR2(32),                     */

                GPSJD       ,/*NUMBER(12,6),                     */

                GPSWD       ,/*NUMBER(12,6),                     */

                GPSHB       ,/*NUMBER(8,2),                      */

                GPSSD       ,/*NUMBER(8,2),                      */

                D_ID2       ,/*CHAR(4),                          */

                B_ID        ,/*CHAR(2)                           */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                :data_fault->str_fault[index].GZSB,

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                trim(:data_fault->DRIVERNAME)  ,/*VARCHAR2(30),                    */

                trim(:data_fault->DRIVERTEL)   ,/*VARCHAR2(32),                    */

                :data_fault->LINENO      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW) ,    /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                //,0

                );

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:FAULT_INVALID故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:FAULT_INVALID故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



/* add by linw 2010325 */

unsigned char insert_to_ITF_FAULT_INVALID_NOPERSON(int index)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_FAULT_INVALID_NOPERSON(

                IDX         ,/*CHAR(32) not null,                */

                GZDM        ,/*NUMBER(10),                       */

                GZLY        ,/*NUMBER(2),                       */

                GZMC        ,/*VARCHAR2(100),                    */

                GZKSSJ      ,/*DATE,                             */

                GZDJ        ,/*NUMBER(2),                        */

                GZDM_WM     ,/*NUMBER(5),                        */

                VER         ,/*NUMBER(3) default 10 not null,    */

                D_ID        ,/*CHAR(4),                          */

                T_TYPE_ID   ,/*CHAR(3),                          */

                LOCO_NO     ,/*CHAR(4),                          */

                AB          ,/*NUMBER(1) default 0,              */

                BTSJ        ,/*DATE,                             */

                RKSJ        ,/*DATE default SYSDATE,             */

                CZH         ,/*NUMBER(5),                        */

                SJJLH       ,/*NUMBER(5),                        */

                SJSD        ,/*NUMBER(7,2),                      */

                JCGKZ       ,/*NUMBER(5),                        */

                XHJBH       ,/*NUMBER(5),                        */

                XHJZLZ      ,/*NUMBER(5),                        */

                CC          ,/*VARCHAR2(20),                     */

                ZSJH        ,/*NUMBER(10),                       */

                FSJH        ,/*NUMBER(10),                       */

                GLB         ,/*NUMBER(10),                       */

                JKZT        ,/*NUMBER(3),                        */

                LINENO      ,/*NUMBER(5),                        */

                LINENAME    ,/*VARCHAR2(32),                     */

                STATIONNAME ,/*VARCHAR2(32),                     */

                GPSJD       ,/*NUMBER(12,6),                     */

                GPSWD       ,/*NUMBER(12,6),                     */

                GPSHB       ,/*NUMBER(8,2),                      */

                GPSSD       ,/*NUMBER(8,2),                      */

                D_ID2       ,/*CHAR(4),                          */

                B_ID        ,/*CHAR(2)                           */

                GZDMSHOW,

                SEND_TYPE

                ,CRK

                )

            VALUES(

                :data_fault->str_fault[index].IDX         ,/*CHAR(32) not null,               */

                :data_fault->str_fault[index].GZDM        ,/*NUMBER(10),                      */

                :data_fault->str_fault[index].GZSB,

                trim(:data_fault->str_fault[index].GZMC)        ,/*VARCHAR2(100),                   */

                to_date(:data_fault->str_fault[index].GZKSSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->str_fault[index].GZDJ        ,/*NUMBER(2),                       */

                :data_fault->str_fault[index].GZDM_WM     ,/*NUMBER(5),                       */

                :data_fault->VER         ,/*NUMBER(3) default 10 not null,   */

                trim(:data_fault->D_ID)        ,/*CHAR(4),                         */

                :data_fault->T_TYPE_ID   ,/*CHAR(3),                         */

                :data_fault->LOCO_NO     ,/*CHAR(4),                         */

                :data_fault->AB          ,/*NUMBER(1) default 0,             */

                to_date(:data_fault->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_fault->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_fault->CZH         ,/*NUMBER(5),                       */

                :data_fault->SJJLH       ,/*NUMBER(5),                       */

                :data_fault->SJSD        ,/*NUMBER(7,2),                     */

                :data_fault->JCGKZ       ,/*NUMBER(5),                       */

                :data_fault->XHJBH       ,/*NUMBER(5),                       */

                :data_fault->XHJZLZ      ,/*NUMBER(5),                       */

                :data_fault->CC          ,/*VARCHAR2(20),                    */

                :data_fault->ZSJH        ,/*NUMBER(10),                      */

                :data_fault->FSJH        ,/*NUMBER(10),                      */

                :data_fault->GLB         ,/*NUMBER(10),                      */

                :data_fault->JKZT        ,/*NUMBER(3),                       */

                :data_fault->LINENO      ,/*NUMBER(5),                       */

                trim(:data_fault->LINENAME)    ,/*VARCHAR2(32),                    */

                trim(:data_fault->STATIONNAME) ,/*VARCHAR2(32),                    */

                :data_fault->GPSJD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSWD       ,/*NUMBER(12,6),                    */

                :data_fault->GPSHB       ,/*NUMBER(8,2),                     */

                :data_fault->GPSSD       ,/*NUMBER(8,2),                     */

                trim(:data_fault->D_ID2)       ,/*CHAR(4),                         */

                trim(:data_fault->B_ID)        ,/*CHAR(2),                         */

                trim(:data_fault->str_fault[index].CODESHOW) ,    /*VARCHAR2(20),                       */

                :data_fault->str_fault[index].SEND_TYPE

                ,:data_fault->CRK

                );

    if (sqlca.sqlcode == 0)

    {

        //		memset(temp,0,1024);

        //		sprintf(temp,"loco.%s-%s:FAULT_INVALID故障入库成功\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO);

        //		lprintf(disp.e,temp);

        //		lprintf(disp.f,temp);

        //		cclog('e',temp);

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:FAULT_INVALID_NOPERSON故障入库失败,ORACLE返回值：%d\n",data_fault->T_TYPE_ID,data_fault->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.f,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_EVENT_LKJALARM_UNTREATED_SJ(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJALARM_UNTREATED (

                IDX         ,/*CHAR(32) not null,       */

                T_TYPE_ID   ,/*CHAR(3 CHAR),            */

                LOCO_NO     ,/*CHAR(4 CHAR),            */

                AB          ,/*NUMBER(1) not null,      */

                D_ID        ,/*CHAR(4),                 */

                BTSJ        ,/*DATE,                    */

                RKSJ        ,/*DATE default SYSDATE,    */

                ETYPE       ,/*NUMBER(5),               */

                SJMC        ,/*VARCHAR2(32) default 0,  */

                SJDJ        ,/*NUMBER(2),               */

                GPSJD       ,/*NUMBER(12,6),            */

                GPSWD       ,/*NUMBER(12,6),            */

                GPSSD       ,/*NUMBER(5,2),             */

                GPSHB       ,/*NUMBER(8,2),             */

                SJ          ,/*DATE,                    */

                CC          ,/*VARCHAR2(20 CHAR),       */

                CZH         ,/*NUMBER(5),               */

                SJH         ,/*NUMBER(10),              */

                FSJH        ,/*NUMBER(10),              */

                SJJLH       ,/*NUMBER(5),               */

                KHBB        ,/*NUMBER(3),               */

                SJSD        ,/*NUMBER(5,2),             */

                JCXH        ,/*NUMBER(5),               */

                GK          ,/*NUMBER(3),               */

                XHJBH       ,/*NUMBER(5),               */

                XHJLB       ,/*NUMBER(5),               */

                GLB         ,/*NUMBER(10),              */

                ZZ          ,/*NUMBER(5),               */

                JC          ,/*NUMBER(6,2),             */

                LS          ,/*NUMBER(5),               */

                LCGYL       ,/*NUMBER(5),               */

                ZZZT        ,/*NUMBER(5),               */

                SRJLH       ,/*NUMBER(5),               */

                JLQFXHJJL   ,/*NUMBER(5),               */

                XS          ,/*NUMBER(5),               */

                ZDSC        ,/*NUMBER(3),               */

                DQXLHBZ     ,/*NUMBER(3),               */

                DQXLH       ,/*NUMBER(5),               */

                QFXLHBZ     ,/*NUMBER(3),               */

                QFXLH       ,/*NUMBER(5),               */

                DQ_TMIS     ,/*NUMBER(8),               */

                QF_TIME     ,/*NUMBER(8),               */

                QFCZJLH     ,/*NUMBER(3),               */

                QFCHZH      ,/*NUMBER(5),               */

                JKZT        ,/*NUMBER(3),               */

                LJWY        ,/*NUMBER(5),               */

                BFQZX       ,/*NUMBER(3),               */

                BFQCX       ,/*NUMBER(3),               */

                QFFQZX      ,/*NUMBER(3),               */

                QFFQCX      ,/*NUMBER(3),               */

                DRIVERNAME  ,/*VARCHAR2(30),            */

                DRIVERTEL   ,/*VARCHAR2(32),            */

                LINENO      ,/*NUMBER(5),               */

                LINENAME    ,/*VARCHAR2(32),            */

                STATIONNAME ,/*VARCHAR2(32),            */

                D_ID2       ,/*CHAR(4),                 */

                B_ID        ,/*CHAR(2),                 */

                B_ID2       ,/*CHAR(2),                 */

                LKJ_TYPE    ,/*NUMBER(3)                */

                LKJSYSTIME,

                OTHERSYSTIME /*OTHERSSYSTIME edit by guo 2016.5.17*/

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)   ,/*CHAR(4),                */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC),/*VARCHAR2(32),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */





                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                to_date(:data_event->str_event[num].SJ,'yyyy-mm-dd hh24:mi:ss'),



                trim(:data_event->str_event[num].CC)         ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */



                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME)    ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID )       ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       ,/*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE  ,    /*NUMBER(3),           */

                to_date(:data_event->str_event[num].LKJ_SJ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->str_event[num].QT_SJ,'yyyy-mm-dd hh24:mi:ss')

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_EVENT_LKJALARM_UNTREATED(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJALARM_UNTREATED (

                IDX         ,/*CHAR(32) not null,       */

                T_TYPE_ID   ,/*CHAR(3 CHAR),            */

                LOCO_NO     ,/*CHAR(4 CHAR),            */

                AB          ,/*NUMBER(1) not null,      */

                D_ID        ,/*CHAR(4),                 */

                BTSJ        ,/*DATE,                    */

                RKSJ        ,/*DATE default SYSDATE,    */

                ETYPE       ,/*NUMBER(5),               */

                SJMC        ,/*VARCHAR2(32) default 0,  */

                SJDJ        ,/*NUMBER(2),               */

                GPSJD       ,/*NUMBER(12,6),            */

                GPSWD       ,/*NUMBER(12,6),            */

                GPSSD       ,/*NUMBER(5,2),             */

                GPSHB       ,/*NUMBER(8,2),             */

                SJ          ,/*DATE,                    */

                CC          ,/*VARCHAR2(20 CHAR),       */

                CZH         ,/*NUMBER(5),               */

                SJH         ,/*NUMBER(10),              */

                FSJH        ,/*NUMBER(10),              */

                SJJLH       ,/*NUMBER(5),               */

                KHBB        ,/*NUMBER(3),               */

                SJSD        ,/*NUMBER(5,2),             */

                JCXH        ,/*NUMBER(5),               */

                GK          ,/*NUMBER(3),               */

                XHJBH       ,/*NUMBER(5),               */

                XHJLB       ,/*NUMBER(5),               */

                GLB         ,/*NUMBER(10),              */

                ZZ          ,/*NUMBER(5),               */

                JC          ,/*NUMBER(6,2),             */

                LS          ,/*NUMBER(5),               */

                LCGYL       ,/*NUMBER(5),               */

                ZZZT        ,/*NUMBER(5),               */

                SRJLH       ,/*NUMBER(5),               */

                JLQFXHJJL   ,/*NUMBER(5),               */

                XS          ,/*NUMBER(5),               */

                ZDSC        ,/*NUMBER(3),               */

                DQXLHBZ     ,/*NUMBER(3),               */

                DQXLH       ,/*NUMBER(5),               */

                QFXLHBZ     ,/*NUMBER(3),               */

                QFXLH       ,/*NUMBER(5),               */

                DQ_TMIS     ,/*NUMBER(8),               */

                QF_TIME     ,/*NUMBER(8),               */

                QFCZJLH     ,/*NUMBER(3),               */

                QFCHZH      ,/*NUMBER(5),               */

                JKZT        ,/*NUMBER(3),               */

                LJWY        ,/*NUMBER(5),               */

                BFQZX       ,/*NUMBER(3),               */

                BFQCX       ,/*NUMBER(3),               */

                QFFQZX      ,/*NUMBER(3),               */

                QFFQCX      ,/*NUMBER(3),               */

                DRIVERNAME  ,/*VARCHAR2(30),            */

                DRIVERTEL   ,/*VARCHAR2(32),            */

                LINENO      ,/*NUMBER(5),               */

                LINENAME    ,/*VARCHAR2(32),            */

                STATIONNAME ,/*VARCHAR2(32),            */

                D_ID2       ,/*CHAR(4),                 */

                B_ID        ,/*CHAR(2),                 */

                B_ID2       ,/*CHAR(2),                 */

                LKJ_TYPE    /*NUMBER(3)                */

                ,CRK

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)   ,/*CHAR(4),                */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC),/*VARCHAR2(32),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */





                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                to_date(:data_event->str_event[num].SJ,'yyyy-mm-dd hh24:mi:ss'),



                trim(:data_event->str_event[num].CC)         ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */



                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME)    ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID )       ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       ,/*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE      /*NUMBER(3),           */

                ,:data_event->CRK

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件EVENT_LKJALARM_UNTREATED入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_EVENT_LKJALARM_SJ(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJALARM (

                IDX          ,/*CHAR(32) not null,                     */

                T_TYPE_ID    ,/*CHAR(3 CHAR),                          */

                LOCO_NO      ,/*CHAR(4 CHAR),                          */

                AB           ,/*NUMBER(1) not null,                    */

                D_ID         ,/*CHAR(4),                               */

                BTSJ         ,/*DATE,                                  */

                RKSJ         ,/*DATE default SYSDATE,                  */

                ETYPE        ,/*NUMBER(5),                             */

                VER          ,/*NUMBER(3),                             */

                SJMC         ,/*VARCHAR2(30),                          */

                SJDJ         ,/*NUMBER(2),                             */

                GPSJD        ,/*NUMBER(12,6),                          */

                GPSWD        ,/*NUMBER(12,6),                          */

                GPSSD        ,/*NUMBER(5,2),                           */

                GPSHB        ,/*NUMBER(8,2),                           */

                SJ           ,/*DATE,                                  */

                CC           ,/*VARCHAR2(20 CHAR),                     */

                CZH          ,/*NUMBER(5),                             */

                SJH          ,/*NUMBER(10),                            */

                FSJH         ,/*NUMBER(10),                            */

                SJJLH        ,/*NUMBER(5),                             */

                KHBB         ,/*NUMBER(3),                             */

                SJSD         ,/*NUMBER(5,2),                           */

                JCXH         ,/*NUMBER(5),                             */

                GK           ,/*NUMBER(3),                             */

                XHJBH        ,/*NUMBER(5),                             */

                XHJLB        ,/*NUMBER(5),                             */

                GLB          ,/*NUMBER(10),                            */

                ZZ           ,/*NUMBER(5),                             */

                JC           ,/*NUMBER(6,2),                           */

                LS           ,/*NUMBER(5),                             */

                LCGYL        ,/*NUMBER(5),                             */

                ZZZT         ,/*NUMBER(5),                             */

                STATIONNAME  ,/*VARCHAR2(32),                          */

                SRJLH        ,/*NUMBER(5),                             */

                JLQFXHJJL    ,/*NUMBER(5),                             */

                XS           ,/*NUMBER(5),                             */

                ZDSC         ,/*NUMBER(3),                             */

                DQXLHBZ      ,/*NUMBER(3),                             */

                DQXLH        ,/*NUMBER(5),                             */

                QFXLHBZ      ,/*NUMBER(3),                             */

                QFXLH        ,/*NUMBER(5),                             */

                DQ_TMIS      ,/*NUMBER(8),                             */

                QF_TIME      ,/*NUMBER(8),                             */

                QFCZJLH      ,/*NUMBER(3),                             */

                QFCHZH       ,/*NUMBER(5),                             */

                JKZT         ,/*NUMBER(3),                             */

                LJWY         ,/*NUMBER(5),                             */

                BFQZX        ,/*NUMBER(3),                             */

                BFQCX        ,/*NUMBER(3),                             */

                QFFQZX       ,/*NUMBER(3),                             */

                QFFQCX       ,/*NUMBER(3),                             */

                DRIVERNAME   ,/*VARCHAR2(30),                          */

                DRIVERTEL    ,/*VARCHAR2(32),                          */

                LINENO       ,/*NUMBER(5),                             */

                LINENAME     ,/*VARCHAR2(32),                          */

                STATIONNAME2 ,/*VARCHAR2(32),                          */

                D_ID2        ,/*CHAR(4),                               */

                B_ID         ,/*CHAR(2),                               */

                B_ID2        ,/*CHAR(2),                               */

                LKJ_TYPE    , /*NUMBER(3)                              */

                LKJSYSTIME,

                OTHERSYSTIME /*OTHERSSYSTIME edit by guo 2016.5.17*/

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                :data_event->str_event[num].VER       ,

                trim(:data_event->str_event[num].SJMC)        ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */



                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),



                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME)    ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME2) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID)        ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       ,/*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE  ,    /*NUMBER(3),           */

                to_date(:data_event->str_event[num].LKJ_SJ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->str_event[num].QT_SJ,'yyyy-mm-dd hh24:mi:ss')

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件EVENT_LKJALARM入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}	



static unsigned char insert_to_ITF_EVENT_LKJALARM(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJALARM (

                IDX          ,/*CHAR(32) not null,                     */

                T_TYPE_ID    ,/*CHAR(3 CHAR),                          */

                LOCO_NO      ,/*CHAR(4 CHAR),                          */

                AB           ,/*NUMBER(1) not null,                    */

                D_ID         ,/*CHAR(4),                               */

                BTSJ         ,/*DATE,                                  */

                RKSJ         ,/*DATE default SYSDATE,                  */

                ETYPE        ,/*NUMBER(5),                             */

                VER          ,/*NUMBER(3),                             */

                SJMC         ,/*VARCHAR2(30),                          */

                SJDJ         ,/*NUMBER(2),                             */

                GPSJD        ,/*NUMBER(12,6),                          */

                GPSWD        ,/*NUMBER(12,6),                          */

                GPSSD        ,/*NUMBER(5,2),                           */

                GPSHB        ,/*NUMBER(8,2),                           */

                SJ           ,/*DATE,                                  */

                CC           ,/*VARCHAR2(20 CHAR),                     */

                CZH          ,/*NUMBER(5),                             */

                SJH          ,/*NUMBER(10),                            */

                FSJH         ,/*NUMBER(10),                            */

                SJJLH        ,/*NUMBER(5),                             */

                KHBB         ,/*NUMBER(3),                             */

                SJSD         ,/*NUMBER(5,2),                           */

                JCXH         ,/*NUMBER(5),                             */

                GK           ,/*NUMBER(3),                             */

                XHJBH        ,/*NUMBER(5),                             */

                XHJLB        ,/*NUMBER(5),                             */

                GLB          ,/*NUMBER(10),                            */

                ZZ           ,/*NUMBER(5),                             */

                JC           ,/*NUMBER(6,2),                           */

                LS           ,/*NUMBER(5),                             */

                LCGYL        ,/*NUMBER(5),                             */

                ZZZT         ,/*NUMBER(5),                             */

                STATIONNAME  ,/*VARCHAR2(32),                          */

                SRJLH        ,/*NUMBER(5),                             */

                JLQFXHJJL    ,/*NUMBER(5),                             */

                XS           ,/*NUMBER(5),                             */

                ZDSC         ,/*NUMBER(3),                             */

                DQXLHBZ      ,/*NUMBER(3),                             */

                DQXLH        ,/*NUMBER(5),                             */

                QFXLHBZ      ,/*NUMBER(3),                             */

                QFXLH        ,/*NUMBER(5),                             */

                DQ_TMIS      ,/*NUMBER(8),                             */

                QF_TIME      ,/*NUMBER(8),                             */

                QFCZJLH      ,/*NUMBER(3),                             */

                QFCHZH       ,/*NUMBER(5),                             */

                JKZT         ,/*NUMBER(3),                             */

                LJWY         ,/*NUMBER(5),                             */

                BFQZX        ,/*NUMBER(3),                             */

                BFQCX        ,/*NUMBER(3),                             */

                QFFQZX       ,/*NUMBER(3),                             */

                QFFQCX       ,/*NUMBER(3),                             */

                DRIVERNAME   ,/*VARCHAR2(30),                          */

                DRIVERTEL    ,/*VARCHAR2(32),                          */

                LINENO       ,/*NUMBER(5),                             */

                LINENAME     ,/*VARCHAR2(32),                          */

                STATIONNAME2 ,/*VARCHAR2(32),                          */

                D_ID2        ,/*CHAR(4),                               */

                B_ID         ,/*CHAR(2),                               */

                B_ID2        ,/*CHAR(2),                               */

                LKJ_TYPE     /*NUMBER(3)                              */

                ,CRK

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                :data_event->str_event[num].VER       ,

                trim(:data_event->str_event[num].SJMC)        ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */



                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),



                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME)    ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME2) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID)        ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       ,/*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE      /*NUMBER(3),           */

                ,:data_event->CRK

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_LKJALARM入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件EVENT_LKJALARM入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_EVENT_LKJ_EVENT(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJ_EVENT (

                IDX         ,/*CHAR(32 CHAR) not null,   */

                T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                LOCO_NO     ,/*CHAR(4 CHAR),           */

                AB          ,/*NUMBER(1),              */

                D_ID        ,/*CHAR(4),                */

                ETYPE       ,/*NUMBER(5),              */

                SJMC        ,/*VARCHAR2(30),           */

                SJDJ        ,/*NUMBER(2),              */

                BTSJ        ,/*DATE,                   */

                RKSJ        ,/*DATE default SYSDATE,   */

                SJ          ,/*DATE,                   */

                GPSJD       ,/*NUMBER(12,6),           */

                GPSWD       ,/*NUMBER(12,6),           */

                GPSSD       ,/*NUMBER(5,2),            */

                GPSHB       ,/*NUMBER(8,2),            */

                CC          ,/*VARCHAR2(20 CHAR),      */

                CZH         ,/*NUMBER(5),              */

                SJH         ,/*NUMBER(10),             */

                FSJH        ,/*NUMBER(10),             */

                SJJLH       ,/*NUMBER(5),              */

                KHBB        ,/*NUMBER(3),              */

                SJSD        ,/*NUMBER(5,2),            */

                JCXHZ       ,/*NUMBER(5),              */

                GK          ,/*NUMBER(3),              */

                XHJBH       ,/*NUMBER(5),              */

                XHJLB       ,/*NUMBER(5),              */

                GLB         ,/*NUMBER(10),             */

                ZZ          ,/*NUMBER(5),              */

                JC          ,/*NUMBER(6,2),            */

                LS          ,/*NUMBER(5),              */

                LCGYL       ,/*NUMBER(5),              */

                ZZZT        ,/*NUMBER(3),              */

                CXSJ        ,/*NUMBER(10),             */

                SJH_BGQ     ,/*NUMBER(10),             */

                FSJH_BGQ    ,/*NUMBER(10),             */

                LKJVER      ,/*VARCHAR2(20),        */

                SRJLH       ,/*NUMBER(5),           */

                JLQFXHJJL   ,/*NUMBER(5),           */

                XS          ,/*NUMBER(5),           */

                ZDSC        ,/*NUMBER(3),           */

                DQXLHBZ     ,/*NUMBER(3),           */

                DQXLH       ,/*NUMBER(5),           */

                QFXLHBZ     ,/*NUMBER(3),           */

                QFXLH       ,/*NUMBER(5),           */

                DQ_TMIS     ,/*NUMBER(8),           */

                QF_TIME     ,/*NUMBER(8),           */

                QFCZJLH     ,/*NUMBER(3),           */

                QFCHZH      ,/*NUMBER(5),           */

                JKZT        ,/*NUMBER(3),           */

                LJWY        ,/*NUMBER(5),           */

                BFQZX       ,/*NUMBER(3),           */

                BFQCX       ,/*NUMBER(3),           */

                QFFQZX      ,/*NUMBER(3),           */

                QFFQCX      ,/*NUMBER(3),           */

                DRIVERNAME  ,/*VARCHAR2(30),        */

                DRIVERTEL   ,/*VARCHAR2(32),        */

                LINENO      ,/*NUMBER(5),           */

                LINENAME    ,/*VARCHAR2(32),        */

                STATIONNAME ,/*VARCHAR2(32),        */

                D_ID2       ,/*CHAR(4),             */

                B_ID        ,/*CHAR(2)              */

                B_ID2       , /*CHAR(2)              */

                LKJ_TYPE   ,

                PRE_STATION,

                PRE_CROSSNO,

                PRE_STATIONNAME,

                PRE_CC

                ,CRK

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC)       ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                :data_event->str_event[num].CXSJ        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJH_BGQ     ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH_BGQ    ,/*NUMBER(10),             */

                trim(:data_event->LKJVER )     ,/*VARCHAR2(20),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME )   ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID)        ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       , /*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE ,     /*NUMBER(3),           */

                :data_event->str_event[num].PRE_CZH,

                :data_event->str_event[num].PRE_JLH,

                trim(:data_event->str_event[num].PRE_CZM),

                trim(:data_event->str_event[num].PRE_CC)

                ,:data_event->CRK

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件LKJ_EVENT入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件LKJ_EVENT入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件LKJ_EVENT入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}



/* add by linw 20160329 */

static unsigned char insert_to_ITF_EVENT_LKJ_EVENT_CRD(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJ_EVENT_CRD (

                IDX         ,/*CHAR(32 CHAR) not null,   */

                T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                LOCO_NO     ,/*CHAR(4 CHAR),           */

                AB          ,/*NUMBER(1),              */

                D_ID        ,/*CHAR(4),                */

                ETYPE       ,/*NUMBER(5),              */

                SJMC        ,/*VARCHAR2(30),           */

                SJDJ        ,/*NUMBER(2),              */

                BTSJ        ,/*DATE,                   */

                RKSJ        ,/*DATE default SYSDATE,   */

                SJ          ,/*DATE,                   */

                GPSJD       ,/*NUMBER(12,6),           */

                GPSWD       ,/*NUMBER(12,6),           */

                GPSSD       ,/*NUMBER(5,2),            */

                GPSHB       ,/*NUMBER(8,2),            */

                CC          ,/*VARCHAR2(20 CHAR),      */

                CZH         ,/*NUMBER(5),              */

                SJH         ,/*NUMBER(10),             */

                FSJH        ,/*NUMBER(10),             */

                SJJLH       ,/*NUMBER(5),              */

                KHBB        ,/*NUMBER(3),              */

                SJSD        ,/*NUMBER(5,2),            */

                JCXHZ       ,/*NUMBER(5),              */

                GK          ,/*NUMBER(3),              */

                XHJBH       ,/*NUMBER(5),              */

                XHJLB       ,/*NUMBER(5),              */

                GLB         ,/*NUMBER(10),             */

                ZZ          ,/*NUMBER(5),              */

                JC          ,/*NUMBER(6,2),            */

                LS          ,/*NUMBER(5),              */

                LCGYL       ,/*NUMBER(5),              */

                ZZZT        ,/*NUMBER(3),              */

                CXSJ        ,/*NUMBER(10),             */

                SJH_BGQ     ,/*NUMBER(10),             */

                FSJH_BGQ    ,/*NUMBER(10),             */

                LKJVER      ,/*VARCHAR2(20),        */

                SRJLH       ,/*NUMBER(5),           */

                JLQFXHJJL   ,/*NUMBER(5),           */

                XS          ,/*NUMBER(5),           */

                ZDSC        ,/*NUMBER(3),           */

                DQXLHBZ     ,/*NUMBER(3),           */

                DQXLH       ,/*NUMBER(5),           */

                QFXLHBZ     ,/*NUMBER(3),           */

                QFXLH       ,/*NUMBER(5),           */

                DQ_TMIS     ,/*NUMBER(8),           */

                QF_TIME     ,/*NUMBER(8),           */

                QFCZJLH     ,/*NUMBER(3),           */

                QFCHZH      ,/*NUMBER(5),           */

                JKZT        ,/*NUMBER(3),           */

                LJWY        ,/*NUMBER(5),           */

                BFQZX       ,/*NUMBER(3),           */

                BFQCX       ,/*NUMBER(3),           */

                QFFQZX      ,/*NUMBER(3),           */

                QFFQCX      ,/*NUMBER(3),           */

                DRIVERNAME  ,/*VARCHAR2(30),        */

                DRIVERTEL   ,/*VARCHAR2(32),        */

                LINENO      ,/*NUMBER(5),           */

                LINENAME    ,/*VARCHAR2(32),        */

                STATIONNAME ,/*VARCHAR2(32),        */

                D_ID2       ,/*CHAR(4),             */

                B_ID        ,/*CHAR(2)              */

                B_ID2       , /*CHAR(2)              */

                LKJ_TYPE   ,

                PRE_STATION,

                PRE_CROSSNO,

                PRE_STATIONNAME,

                PRE_CC

                ,CRK

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC)       ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                :data_event->str_event[num].CXSJ        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJH_BGQ     ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH_BGQ    ,/*NUMBER(10),             */

                trim(:data_event->LKJVER )     ,/*VARCHAR2(20),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME )   ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID)        ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       , /*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE ,     /*NUMBER(3),           */

                :data_event->str_event[num].PRE_CZH,

                :data_event->str_event[num].PRE_JLH,

                trim(:data_event->str_event[num].PRE_CZM),

                trim(:data_event->str_event[num].PRE_CC)

                ,:data_event->CRK

                ) ;



    //printf("data_event->CRK = %d\n",data_event->CRK);

    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件ITF_EVENT_LKJ_EVENT_CRD入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        //        if(data_event->key == 14550920)

        //        {

        //            printf("loco.%s-%s:事件ITF_EVENT_LKJ_EVENT_CRD入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        //        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件ITF_EVENT_LKJ_EVENT_CRD入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}



/* add by guo 20160612 */

static unsigned char insert_to_ITF_EVENT_LKJ_EVENT_CRD_N(int num,int crk)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_LKJ_EVENT_CRD (

                IDX         ,/*CHAR(32 CHAR) not null,   */

                T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                LOCO_NO     ,/*CHAR(4 CHAR),           */

                AB          ,/*NUMBER(1),              */

                D_ID        ,/*CHAR(4),                */

                ETYPE       ,/*NUMBER(5),              */

                SJMC        ,/*VARCHAR2(30),           */

                SJDJ        ,/*NUMBER(2),              */

                BTSJ        ,/*DATE,                   */

                RKSJ        ,/*DATE default SYSDATE,   */

                SJ          ,/*DATE,                   */

                GPSJD       ,/*NUMBER(12,6),           */

                GPSWD       ,/*NUMBER(12,6),           */

                GPSSD       ,/*NUMBER(5,2),            */

                GPSHB       ,/*NUMBER(8,2),            */

                CC          ,/*VARCHAR2(20 CHAR),      */

                CZH         ,/*NUMBER(5),              */

                SJH         ,/*NUMBER(10),             */

                FSJH        ,/*NUMBER(10),             */

                SJJLH       ,/*NUMBER(5),              */

                KHBB        ,/*NUMBER(3),              */

                SJSD        ,/*NUMBER(5,2),            */

                JCXHZ       ,/*NUMBER(5),              */

                GK          ,/*NUMBER(3),              */

                XHJBH       ,/*NUMBER(5),              */

                XHJLB       ,/*NUMBER(5),              */

                GLB         ,/*NUMBER(10),             */

                ZZ          ,/*NUMBER(5),              */

                JC          ,/*NUMBER(6,2),            */

                LS          ,/*NUMBER(5),              */

                LCGYL       ,/*NUMBER(5),              */

                ZZZT        ,/*NUMBER(3),              */

                CXSJ        ,/*NUMBER(10),             */

                SJH_BGQ     ,/*NUMBER(10),             */

                FSJH_BGQ    ,/*NUMBER(10),             */

                LKJVER      ,/*VARCHAR2(20),        */

                SRJLH       ,/*NUMBER(5),           */

                JLQFXHJJL   ,/*NUMBER(5),           */

                XS          ,/*NUMBER(5),           */

                ZDSC        ,/*NUMBER(3),           */

                DQXLHBZ     ,/*NUMBER(3),           */

                DQXLH       ,/*NUMBER(5),           */

                QFXLHBZ     ,/*NUMBER(3),           */

                QFXLH       ,/*NUMBER(5),           */

                DQ_TMIS     ,/*NUMBER(8),           */

                QF_TIME     ,/*NUMBER(8),           */

                QFCZJLH     ,/*NUMBER(3),           */

                QFCHZH      ,/*NUMBER(5),           */

                JKZT        ,/*NUMBER(3),           */

                LJWY        ,/*NUMBER(5),           */

                BFQZX       ,/*NUMBER(3),           */

                BFQCX       ,/*NUMBER(3),           */

                QFFQZX      ,/*NUMBER(3),           */

                QFFQCX      ,/*NUMBER(3),           */

                DRIVERNAME  ,/*VARCHAR2(30),        */

                DRIVERTEL   ,/*VARCHAR2(32),        */

                LINENO      ,/*NUMBER(5),           */

                LINENAME    ,/*VARCHAR2(32),        */

                STATIONNAME ,/*VARCHAR2(32),        */

                D_ID2       ,/*CHAR(4),             */

                B_ID        ,/*CHAR(2)              */

                B_ID2       , /*CHAR(2)              */

                LKJ_TYPE   ,

                PRE_STATION,

                PRE_CROSSNO,

                PRE_STATIONNAME,

                PRE_CC

                ,CRK

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC)       ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                :data_event->str_event[num].CXSJ        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJH_BGQ     ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH_BGQ    ,/*NUMBER(10),             */

                trim(:data_event->LKJVER )     ,/*VARCHAR2(20),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME)  ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL)   ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO)      ,/*NUMBER(5),           */

                trim(:data_event->LINENAME )   ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME) ,/*VARCHAR2(32),        */

                trim(:data_event->D_ID2)       ,/*CHAR(4),             */

                trim(:data_event->B_ID)        ,/*CHAR(2)              */

                trim(:data_event->B_ID2)       , /*CHAR(2)              */

                :data_event->str_event[num].LKJ_TYPE ,     /*NUMBER(3),           */

                :data_event->str_event[num].PRE_CZH,

                :data_event->str_event[num].PRE_JLH,

                trim(:data_event->str_event[num].PRE_CZM),

                trim(:data_event->str_event[num].PRE_CC)

                ,:crk

                ) ;

				EXEC SQL COMMIT;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            ///printf("loco.%s-%s:crk事件ITF_EVENT_LKJ_EVENT_CRD入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }

        //printf("loco.%s-%s:crk11事件ITF_EVENT_LKJ_EVENT_CRD入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        return 0;

    }

    else

    {

        //printf("loco.%s-%s:crk事件ITF_EVENT_LKJ_EVENT_CRD入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:crk事件ITF_EVENT_LKJ_EVENT_CRD入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        cclog('e',temp);

        return 1;

    }

}





static unsigned char insert_to_ITF_EVENT_INVALID(int num)

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_EVENT_INVALID (

                IDX         ,/*CHAR(32 CHAR) not null,   */

                T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                LOCO_NO     ,/*CHAR(4 CHAR),           */

                AB          ,/*NUMBER(1),              */

                D_ID        ,/*CHAR(4),                */

                ETYPE       ,/*NUMBER(5),              */

                SJMC        ,/*VARCHAR2(30),           */

                SJDJ        ,/*NUMBER(2),              */

                BTSJ        ,/*DATE,                   */

                RKSJ        ,/*DATE default SYSDATE,   */



                GPSJD       ,/*NUMBER(12,6),           */

                GPSWD       ,/*NUMBER(12,6),           */

                GPSSD       ,/*NUMBER(5,2),            */

                GPSHB       ,/*NUMBER(8,2),            */

                SJ          ,/*DATE,                   */

                CC          ,/*VARCHAR2(20 CHAR),      */

                CZH         ,/*NUMBER(5),              */

                SJH         ,/*NUMBER(10),             */

                FSJH        ,/*NUMBER(10),             */

                SJJLH       ,/*NUMBER(5),              */

                KHBB        ,/*NUMBER(3),              */

                SJSD        ,/*NUMBER(5,2),            */

                JCXHZ       ,/*NUMBER(5),              */

                GK          ,/*NUMBER(3),              */

                XHJBH       ,/*NUMBER(5),              */

                XHJLB       ,/*NUMBER(5),              */

                GLB         ,/*NUMBER(10),             */

                ZZ          ,/*NUMBER(5),              */

                JC          ,/*NUMBER(6,2),            */

                LS          ,/*NUMBER(5),              */

                LCGYL       ,/*NUMBER(5),              */

                ZZZT        ,/*NUMBER(3),              */

                CXSJ        ,/*NUMBER(10),             */

                SJH_BGQ     ,/*NUMBER(10),             */

                FSJH_BGQ    ,/*NUMBER(10),             */

                LKJVER      ,/*VARCHAR2(20),        */

                SRJLH       ,/*NUMBER(5),           */

                JLQFXHJJL   ,/*NUMBER(5),           */

                XS          ,/*NUMBER(5),           */

                ZDSC        ,/*NUMBER(3),           */

                DQXLHBZ     ,/*NUMBER(3),           */

                DQXLH       ,/*NUMBER(5),           */

                QFXLHBZ     ,/*NUMBER(3),           */

                QFXLH       ,/*NUMBER(5),           */

                DQ_TMIS     ,/*NUMBER(8),           */

                QF_TIME     ,/*NUMBER(8),           */

                QFCZJLH     ,/*NUMBER(3),           */

                QFCHZH      ,/*NUMBER(5),           */

                JKZT        ,/*NUMBER(3),           */

                LJWY        ,/*NUMBER(5),           */

                BFQZX       ,/*NUMBER(3),           */

                BFQCX       ,/*NUMBER(3),           */

                QFFQZX      ,/*NUMBER(3),           */

                QFFQCX      ,/*NUMBER(3),           */

                DRIVERNAME  ,/*VARCHAR2(30),        */

                DRIVERTEL   ,/*VARCHAR2(32),        */

                LINENO      ,/*NUMBER(5),           */

                LINENAME    ,/*VARCHAR2(32),        */

                STATIONNAME ,/*VARCHAR2(32),        */

                LKJ_TYPE

                ,CRK

                /*D_ID2       ,/*CHAR(4),             */

                /*B_ID        /*CHAR(2)              */

                )

            VALUES(

                :data_event->str_event[num].IDX         ,/*CHAR(32 CHAR) not null,   */

                :data_event->T_TYPE_ID   ,/*CHAR(3 CHAR),           */

                :data_event->LOCO_NO     ,/*CHAR(4 CHAR),           */

                :data_event->AB          ,/*NUMBER(1),              */

                trim(:data_event->D_ID)        ,/*CHAR(4),                */

                :data_event->str_event[num].ETYPE       ,/*NUMBER(5),              */

                trim(:data_event->str_event[num].SJMC)        ,/*VARCHAR2(30),           */

                :data_event->str_event[num].SJDJ        ,/*NUMBER(2),              */

                to_date(:data_event->RKSJ ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_event->BTSJ ,'yyyy-mm-dd hh24:mi:ss'),



                :data_event->GPSJD       ,/*NUMBER(12,6),           */

                :data_event->GPSWD       ,/*NUMBER(12,6),           */

                :data_event->GPSSD       ,/*NUMBER(5,2),            */

                :data_event->GPSHB       ,/*NUMBER(8,2),            */

                to_date(:data_event->str_event[num].SJ ,'yyyy-mm-dd hh24:mi:ss'),

                :data_event->str_event[num].CC          ,/*VARCHAR2(20 CHAR),      */

                :data_event->str_event[num].CZH         ,/*NUMBER(5),              */

                :data_event->str_event[num].SJH         ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJJLH       ,/*NUMBER(5),              */

                :data_event->str_event[num].KHBB        ,/*NUMBER(3),              */

                :data_event->str_event[num].SJSU        ,/*NUMBER(5,2),            */

                :data_event->str_event[num].JCXHZ       ,/*NUMBER(5),              */

                :data_event->str_event[num].GK          ,/*NUMBER(3),              */

                :data_event->str_event[num].XHJBH       ,/*NUMBER(5),              */

                :data_event->str_event[num].XHJLB       ,/*NUMBER(5),              */

                :data_event->str_event[num].GLB         ,/*NUMBER(10),             */

                :data_event->str_event[num].ZZ          ,/*NUMBER(5),              */

                :data_event->str_event[num].JC          ,/*NUMBER(6,2),            */

                :data_event->str_event[num].LS          ,/*NUMBER(5),              */

                :data_event->str_event[num].LCGYL       ,/*NUMBER(5),              */

                :data_event->str_event[num].ZZZT        ,/*NUMBER(3),              */

                :data_event->str_event[num].CXSJ        ,/*NUMBER(10),             */

                :data_event->str_event[num].SJH_BGQ     ,/*NUMBER(10),             */

                :data_event->str_event[num].FSJH_BGQ    ,/*NUMBER(10),             */

                trim(:data_event->LKJVER)      ,/*VARCHAR2(20),        */

                :data_event->str_event[num].SRJLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].JLQFXHJJL   ,/*NUMBER(5),           */

                :data_event->str_event[num].XS          ,/*NUMBER(5),           */

                :data_event->str_event[num].ZDSC        ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].DQXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].QFXLHBZ     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFXLH       ,/*NUMBER(5),           */

                :data_event->str_event[num].DQ_TMIS     ,/*NUMBER(8),           */

                :data_event->str_event[num].QF_TIME     ,/*NUMBER(8),           */

                :data_event->str_event[num].QFCZJLH     ,/*NUMBER(3),           */

                :data_event->str_event[num].QFCHZH      ,/*NUMBER(5),           */

                :data_event->str_event[num].JKZT        ,/*NUMBER(3),           */

                :data_event->str_event[num].LJWY        ,/*NUMBER(5),           */

                :data_event->str_event[num].BFQZX       ,/*NUMBER(3),           */

                :data_event->str_event[num].BFQCX       ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQZX      ,/*NUMBER(3),           */

                :data_event->str_event[num].QFFQCX      ,/*NUMBER(3),           */

                trim(:data_event->DRIVERNAME ) ,/*VARCHAR2(30),        */

                trim(:data_event->DRIVERTEL  )  ,/*VARCHAR2(32),        */

                trim(:data_event->LINENO  )     ,/*NUMBER(5),           */

                trim(:data_event->LINENAME  )   ,/*VARCHAR2(32),        */

                trim(:data_event->STATIONNAME ) ,/*VARCHAR2(32),        */

                :data_event->str_event[num].LKJ_TYPE   /*NUMBER(3),           */

                ,:data_event->CRK

                /*:data_event->D_ID2       ,CHAR(4),             */

                /*:data_event->B_ID        CHAR(2)              */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_INVALID入库成功\n",data_event->T_TYPE_ID,data_event->LOCO_NO);

        }





        return 0;

    }

    else

    {

        if(data_event->key == 14550920)

        {

            //printf("loco.%s-%s:事件EVENT_INVALID入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        }

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:事件EVENT_INVALID入库失败,ORACLE返回值：%d\n",data_event->T_TYPE_ID,data_event->LOCO_NO,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.v,temp);

        //cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_BD_HEADER_CT()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_BD_HEADER (

                IDX       ,/*CHAR(32) not null,               */

                T_TYPE_ID ,/*CHAR(3),                         */

                LOCO_NO   ,/*CHAR(4 CHAR),                    */

                AB        ,/*NUMBER(1),                       */

                BTSJ      ,/*DATE,                            */

                RKSJ      ,/*DATE default SYSDATE,            */

                XXLX      ,/*NUMBER(3),                       */

                ZH        ,/*NUMBER(5),                       */

                SJCD      ,/*NUMBER(5),                       */

                JD        ,/*NUMBER(12,6),                    */

                WD        ,/*NUMBER(12,6),                    */

                SD        ,/*NUMBER(8,2),                     */

                HB        ,/*NUMBER(8,2),                     */

                VER       ,/*NUMBER(3) default 10 not null,   */

                GZDM1     ,/*NUMBER(10),                      */

                GZDM2     ,/*NUMBER(10),                      */

                GZDM3     ,/*NUMBER(10),                      */

                SS        ,/*NUMBER(1),                       */

                KZHX      ,/*NUMBER(1),                       */

                ZDH       ,/*NUMBER(1),                       */

                SDGZT     ,/*NUMBER(1),                       */

                CZD       ,/*NUMBER(1),                       */

                JCYXFX    ,/*NUMBER(1),                       */

                JCGK      ,/*NUMBER(1),                       */

                GFX       ,/*NUMBER(1),                       */

                SBJW      ,/*NUMBER(5,1),                     */

                QYZDL     ,/*NUMBER(5),                       */

                SJSD      ,/*NUMBER(5,2),                     */

                XDCDY     ,/*NUMBER(5,1),                     */

                WYZFDY    ,/*NUMBER(5),                       */

                WLZFDL    ,/*NUMBER(5),                       */

                ZFGYL     ,/*NUMBER(5),                       */

                LCGYL     ,/*NUMBER(5),                       */

                ZDGYL     ,/*NUMBER(5),                       */

                CC        ,/*VARCHAR2(20),                    */

                GLB       ,/*NUMBER(11),                      */

                ZSJH      /*NUMBER(10)                       */

                )

            VALUES(

                :data_bd->idx         ,/*CHAR(32 CHAR) not null,   */

                :data_bd->t_type_id   ,/*CHAR(3 CHAR),           */

                :data_bd->loco_no     ,/*CHAR(4 CHAR),           */

                :data_bd->ab          ,/*NUMBER(1),              */

                to_date(:data_bd->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_bd->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                :data_bd->xxlx    ,/*NUMBER(3),                       */

                :data_bd->zh        ,/*NUMBER(5),                       */

                :data_bd->sjcd      ,/*NUMBER(5),                       */

                :data_bd->jd        ,/*NUMBER(12,6),                    */

                :data_bd->wd        ,/*NUMBER(12,6),                    */

                :data_bd->sd        ,/*NUMBER(8,2),                     */

                :data_bd->hb        ,/*NUMBER(8,2),                     */

                :data_bd->ver       ,/*NUMBER(3) default 10 not null,   */

                :data_bd->gzdm1     ,/*NUMBER(10),                      */

                :data_bd->gzdm2     ,/*NUMBER(10),                      */

                :data_bd->gzdm3     ,/*NUMBER(10),                      */

                :data_bd->ss        ,/*NUMBER(1),                       */

                :data_bd->kzhx      ,/*NUMBER(1),                       */

                :data_bd->zdh       ,/*NUMBER(1),                       */

                :data_bd->sdgzt     ,/*NUMBER(1),                       */

                :data_bd->czd       ,/*NUMBER(1),                       */

                :data_bd->jcyxfx    ,/*NUMBER(1),                       */

                :data_bd->jcgk      ,/*NUMBER(1),                       */

                :data_bd->gfx       ,/*NUMBER(1),                       */

                :data_bd->sbjw      ,/*NUMBER(5,1),                     */

                :data_bd->qyzdl     ,/*NUMBER(5),                       */

                :data_bd->sjsd      ,/*NUMBER(5,2),                     */

                :data_bd->xdcdy     ,/*NUMBER(5,1),                     */

                :data_bd->wyzfdy    ,/*NUMBER(5),                       */

                :data_bd->wlzfdl    ,/*NUMBER(5),                       */

                :data_bd->zfgyl     ,/*NUMBER(5),                       */

                :data_bd->lcgyl     ,/*NUMBER(5),                       */

                :data_bd->zdgyl     ,/*NUMBER(5),                       */

                :data_bd->cc        ,/*VARCHAR2(20),                    */

                :data_bd->glb       ,/*NUMBER(11),                      */

                :data_bd->zsjh      /*NUMBER(10)                       */

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:北斗CT入库失败,ORACLE返回值：%d\n",data_bd->t_type_id,data_bd->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.b,temp);

        cclog('e',temp);

        return 1;

    }

}



static unsigned char insert_to_ITF_BD_HEADER_WH()

{

    char temp[1024];

    EXEC SQL WHENEVER SQLERROR CONTINUE;

    EXEC SQL

            INSERT INTO ITF_BD_HEADER (

                IDX       ,/*CHAR(32) not null,               */

                T_TYPE_ID ,/*CHAR(3),                         */

                LOCO_NO   ,/*CHAR(4 CHAR),                    */

                AB        ,/*NUMBER(1),                       */

                BTSJ      ,/*DATE,                            */

                RKSJ      ,/*DATE default SYSDATE,            */

                XXLX      ,/*NUMBER(3),                       */

                ZH        ,/*NUMBER(5),                       */

                SJCD      ,/*NUMBER(5),                       */

                JD        ,/*NUMBER(12,6),                    */

                WD        ,/*NUMBER(12,6),                    */

                SD        ,/*NUMBER(8,2),                     */

                HB        ,/*NUMBER(8,2),                     */

                VER       ,/*NUMBER(3) default 10 not null,   */

                GZDM1     ,/*NUMBER(10),                      */

                GZDM2     ,/*NUMBER(10),                      */

                GZDM3     /*NUMBER(10),                      */

                )

            VALUES(

                :data_bd->idx         ,/*CHAR(32 CHAR) not null,   */

                :data_bd->t_type_id   ,/*CHAR(3 CHAR),           */

                :data_bd->loco_no     ,/*CHAR(4 CHAR),           */

                :data_bd->ab          ,/*NUMBER(1),              */

                to_date(:data_bd->rksj ,'yyyy-mm-dd hh24:mi:ss'),

                to_date(:data_bd->btsj ,'yyyy-mm-dd hh24:mi:ss'),

                :data_bd->xxlx     ,/*NUMBER(3),                       */

                :data_bd->zh        ,/*NUMBER(5),                       */

                :data_bd->sjcd      ,/*NUMBER(5),                       */

                :data_bd->jd        ,/*NUMBER(12,6),                    */

                :data_bd->wd        ,/*NUMBER(12,6),                    */

                :data_bd->sd        ,/*NUMBER(8,2),                     */

                :data_bd->hb        ,/*NUMBER(8,2),                     */

                :data_bd->ver       ,/*NUMBER(3) default 10 not null,   */

                :data_bd->gzdm1     ,/*NUMBER(10),                      */

                :data_bd->gzdm2     ,/*NUMBER(10),                      */

                :data_bd->gzdm3

                ) ;



    if (sqlca.sqlcode == 0)

    {

        return 0;

    }

    else

    {

        memset(temp,0,1024);

        sprintf(temp,"loco.%s-%s:北斗WH入库失败,ORACLE返回值：%d\n",data_bd->t_type_id,data_bd->loco_no,sqlca.sqlcode);

        lprintf(disp.e,temp);

        lprintf(disp.b,temp);

        //cclog('e',temp);

        return 1;

    }

}



unsigned char insert_3G(struct STR_TRAIN_DATA_3G data)
{
    unsigned char flag;
    data_3g = &data;

    if(data_3g->flag_datahead)
    {
        //文件头数据块入库
        flag = insert_to_ITF_3G_HEADER();
        if (flag == 1)/*插入失败*/
        {
            return 1;
        }
    }

    if(data_3g->flag_selfcheck == 1)
    {
        insert_to_ITF_LDP_SELFCHECK();
        if(Insert_num >= COMMITNUM)
        {
            EXEC SQL COMMIT;
        }
        else
        {
            Insert_num++;
        }
        return 0;
    }

    if (data_3g->flag_6a == 1)
    {
        //insert_to_ITF_6A();
		update_ITF_6A();
    }

    if (data_3g->flag_tax == 1)
    {
        if (data_3g->tax_ver == 10)
        {		
            //insert_to_ITF_TAXV10();
            update_ITF_TAXV10();
        }
        else
        {		
            //insert_to_ITF_TAXV2X();
            update_ITF_TAXV2X();
        }
    }

    if(data_3g->flag_6a_lw == 1)
    {
        insert_to_ITF_6A_AV4();
    }
    if(data_3g->flag_6a_dn == 1)
    {
        insert_to_ITF_6A_DN();
    }
    if(data_3g->flag_6a_yw == 1)
    {
        insert_to_ITF_6A_YW();
    }

    if (data_3g->flag_tcms == 1)
    {
        //insert_to_ITF_TCMS_V10();
        update_ITF_TCMS_V10();
    }
    else if (data_3g->flag_tcms == 2)
    {
        //insert_ITF_TCMS_HXN3_V10();
        update_ITF_TCMS_HXN3_V10();
    }
    else if (data_3g->flag_tcms == 3)
    {
        //insert_ITF_TCMS_HXD_V20();
        update_ITF_TCMS_HXD_V20();
    }
    else if (data_3g->flag_tcms == 4)
    {
        //insert_ITF_TCMS_HXN_V20();
        update_ITF_TCMS_HXN_V20();
    }
    else
    {
        ;
    }



    if(Insert_num >= COMMITNUM)

    {

        EXEC SQL COMMIT;

    }

    else

    {

        Insert_num++;

    }

    return 0;

}



unsigned char insert_FAULT(struct STR_TRAIN_DATA_FAULT data)

{

    int i;

    data_fault = &data;



    for (i=0;i<data_fault->faultnum;i++)

    {

        if (data_fault->VALIDECHECK == 1)

        {

            /* add by linw 20160325 */

            insert_to_ITF_FAULT_INVALID_NOPERSON(i);                //未查找到司机号对应司机名

        } else

        {

            if (data_fault->str_fault[i].VALIDECHECK == 1)

            {

                insert_to_ITF_FAULT_INVALID(i);            //未查找到故障名称和故障描述

            } else

            {

                /* add by guoyj 20160325 */

                if((11 == data_fault->VER) ||

                        (21 == data_fault->VER) ||

                        (12 == data_fault->VER) ||

                        (22 == data_fault->VER))

                {

                    if (data_fault->str_fault[i].GZZT == 0)

                    {

                        if (data_fault->str_fault[i].GZSB == 1)

                        {

                            if (data_fault->str_fault[i].GZDJ == 4)

                            {

                                insert_to_ITF_TCMSFAULT_D_START(i);/*TCMS故障D级故障-开始*/



                            } else

                            {

                                insert_to_ITF_TCMSFAULT_START(i);/*TCMS故障A、B、C级故障-开始*/

                            }

                        } else if(data_fault->str_fault[i].GZSB == 2)

                        {

                            insert_to_ITF_6AFAULT_START(i);/*6a故障A、B、C级故障-开始*/

                        } else if(data_fault->str_fault[i].GZSB == 3)

                        {

                            insert_to_ITF_LDPFAULT_START(i);

                        }

                        insert_to_ITF_FAULT_UNTREATED(i);

                    }

                    else

                    {

                        if (data_fault->str_fault[i].GZSB == 1)

                        {

                            insert_to_ITF_TCMSFAULT_STOP(i);/*TCMS故障-结束*/

                        } else if(data_fault->str_fault[i].GZSB == 2)

                        {

                            insert_to_ITF_6AFAULT_STOP(i);/*6A故障-结束*/

                        } else if(data_fault->str_fault[i].GZSB == 3)

                        {

                            insert_to_ITF_LDPFAULT_STOP(i);

                        }

                    }

                } else

                {

                    if (data_fault->str_fault[i].GZZT == 1)

                    {

                        if (data_fault->str_fault[i].GZSB == 1)

                        {

                            if (data_fault->str_fault[i].GZDJ == 4)

                            {

                                insert_to_ITF_TCMSFAULT_D_START(i);//TCMS故障D级故障-开始

                            } else

                            {

                                insert_to_ITF_TCMSFAULT_START(i);  //TCMS故障A、B、C级故障-开始

                            }

                        } else if(data_fault->str_fault[i].GZSB == 2)

                        {

                            insert_to_ITF_6AFAULT_START(i);    //TCMS故障A、B、C级故障-开始

                        } else if(data_fault->str_fault[i].GZSB == 3)

                        {

                            insert_to_ITF_LDPFAULT_START(i);

                        }



                        insert_to_ITF_FAULT_UNTREATED(i);

                    } else

                    {

                        if (data_fault->str_fault[i].GZSB == 1)

                        {

                            insert_to_ITF_TCMSFAULT_STOP(i);   //TCMS故障-结束

                        } else if(data_fault->str_fault[i].GZSB == 2)

                        {

                            insert_to_ITF_6AFAULT_STOP(i);     //6A故障-结束

                        } else if(data_fault->str_fault[i].GZSB == 3)

                        {

                            insert_to_ITF_LDPFAULT_STOP(i);

                        }

                    }

                }

            }

        }

    }



    if(Insert_num >= COMMITNUM)

    {

        EXEC SQL COMMIT;

    }

    else

    {

        Insert_num++;

    }

    return 0;

}



unsigned char insert_BD(struct STR_TRAIN_DATA_BD data)

{

    unsigned char flag;

    data_bd = &data;

    if (data_bd->xxlx == 0x01)

    {

        insert_to_ITF_BD_HEADER_CT();/*常态报文插入*/

    }

    else if (data_bd->xxlx == 0x05)

    {

        insert_to_ITF_BD_HEADER_WH();/*掉电回送报文插入*/

    }



    if(Insert_num >= COMMITNUM)

    {

        EXEC SQL COMMIT;

    }

    else

    {

        Insert_num++;

    }



    return 0;

}



unsigned char insert_EVENT(struct STR_TRAIN_DATA_EVENT data)

{

    int i;

    data_event = &data;



    for (i=0;i<data_event->eventnum;i++)

    {

        /*add by guo 20160611 start */

        if(409 == data_event->str_event[i].ETYPE)

        {/*1：出库*/

            data_event->CRK = 1;

            update_Train_CRK(1);

            insert_to_ITF_EVENT_LKJ_EVENT_CRD_N(i,1);

        }else if(410 == data_event->str_event[i].ETYPE)

        {/*2：入库*/

            data_event->CRK = 2;

            update_Train_CRK(2);

            insert_to_ITF_EVENT_LKJ_EVENT_CRD_N(i,2);

        }

        /*add by guo 20160611 end */





        /*add by guo 20160523 start */

        //printf("data_event->str_event[i].ETYPE) = %d\n",data_event->str_event[i].ETYPE);

        if((409 == data_event->str_event[i].ETYPE) ||(410 == data_event->str_event[i].ETYPE) )

        {

            ;//insert_to_ITF_EVENT_LKJ_EVENT_CRD(i);

        }

        else if (data_event->VALIDECHECK == 1) /*add by guo 20160523 end */

        {

            insert_to_ITF_EVENT_INVALID(i);                /*未找到司机名事件*/

        }

        else

        {

            if (data_event->str_event->VALIDECHECK == 1)

            {

                insert_to_ITF_EVENT_INVALID(i);            /*未找到事件名、事件描述*/

            }

            else

            {

                if (data_event->str_event->SJDJ == 4)

                {

                    /* add by linw 20160329 */

                    if((409 == data_event->str_event[i].ETYPE) ||

                            (410 == data_event->str_event[i].ETYPE) )

                    {

                        //insert_to_ITF_EVENT_LKJ_EVENT_CRD(i);/*edit by guo 20160523*/

                    } else

                    {

                        insert_to_ITF_EVENT_LKJ_EVENT(i);  /*cmd系统所需数据*/

                    }

                }

                else

                {

                    if((0xE0 == data_event->str_event[i].ETYPE) ||

                            (0xE1 == data_event->str_event[i].ETYPE) )

                    {

                        insert_to_ITF_EVENT_LKJALARM_SJ(i);/*120处理所需数据*/

                        insert_to_ITF_EVENT_LKJALARM_UNTREATED_SJ(i);/*120处理所需数据-未处理表*/

                    }

                    else

                    {

                        insert_to_ITF_EVENT_LKJALARM(i);   /*120处理所需数据*/

                        insert_to_ITF_EVENT_LKJALARM_UNTREATED(i);/*120处理所需数据-未处理表*/

                    }



                }

            }

        }

    }

    if(Insert_num >= COMMITNUM)

    {

        EXEC SQL COMMIT;

    }

    else

    {

        Insert_num++;

    }

    return 0;

}

